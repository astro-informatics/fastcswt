<HTML>
<HEAD>
   <TITLE> program s2_grf2 (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Program s2_grf2 </H1>
<PRE>program s2_grf2

        ! Uses
    use <A HREF="s2_types_mod.html">s2_types_mod</A>
    use <A HREF="s2_error_mod.html">s2_error_mod</A>
    use <A HREF="s2_sky_mod.html">s2_sky_mod</A>
    use <A HREF="s2_distn_mod.html">s2_distn_mod</A>
    use <A HREF="s2_pl_mod.html">s2_pl_mod</A>

        ! Calls
    call parse_options
    call s2_error
    call s2_pl_free
    call s2_pl_get_spec
    call s2_sky_compute_map
    call s2_sky_free
    call s2_sky_io_fits_write
    call s2_sky_write_map_file
    call system_clock

        ! Variables
    character (len=*), parameter :: <A HREF="s2_grf2.html#var_map_file">MAP_FILE</A> = 'map'
    character (len=*), parameter :: <A HREF="s2_grf2.html#var_sky_file">SKY_FILE</A> = 'sky'
    character (len=S2_STRING_LEN) :: <A HREF="s2_grf2.html#var_file_type_str">file_type_str</A> = MAP_FILE
    character (len=S2_STRING_LEN) :: <A HREF="s2_grf2.html#var_filename_out_a">filename_out_a</A> = 'a.tmp'
    character (len=S2_STRING_LEN) :: <A HREF="s2_grf2.html#var_filename_out_b">filename_out_b</A> = 'b.tmp'
    character (len=S2_STRING_LEN) :: <A HREF="s2_grf2.html#var_filename_al">filename_al</A>
    character (len=S2_STRING_LEN) :: <A HREF="s2_grf2.html#var_filename_bl">filename_bl</A>
    character (len=S2_STRING_LEN) :: <A HREF="s2_grf2.html#var_filename_xl">filename_xl</A>
    logical :: <A HREF="s2_grf2.html#var_scale_al">scale_al</A> = .false.
    logical :: <A HREF="s2_grf2.html#var_scale_bl">scale_bl</A> = .false.
    logical :: <A HREF="s2_grf2.html#var_scale_xl">scale_xl</A> = .false.
    integer :: <A HREF="s2_grf2.html#var_ncomment_al">ncomment_al</A> = 0
    integer :: <A HREF="s2_grf2.html#var_ncomment_bl">ncomment_bl</A> = 0
    integer :: <A HREF="s2_grf2.html#var_ncomment_xl">ncomment_xl</A> = 0
    logical :: <A HREF="s2_grf2.html#var_line_nos">line_nos</A>
    integer :: <A HREF="s2_grf2.html#var_seed">seed</A> = 0
    logical :: <A HREF="s2_grf2.html#var_seed_set">seed_set</A> = .false.
    real (kind=s2_sp) :: <A HREF="s2_grf2.html#var_mean_zero">MEAN_ZERO</A> = 0e0
    real (kind=s2_sp) :: <A HREF="s2_grf2.html#var_std_unit">STD_UNIT</A> = 1e0
    integer :: <A HREF="s2_grf2.html#var_l">l</A>
    integer :: <A HREF="s2_grf2.html#var_m">m</A>
    integer :: <A HREF="s2_grf2.html#var_fail">fail</A>
    integer :: <A HREF="s2_grf2.html#var_nside">nside</A>
    integer :: <A HREF="s2_grf2.html#var_lmin">lmin</A>
    integer :: <A HREF="s2_grf2.html#var_lmax">lmax</A>
    logical :: <A HREF="s2_grf2.html#var_nside_set">nside_set</A> = .false.
    real (kind=s2_dp) :: <A HREF="s2_grf2.html#var_a">a</A>
    real (kind=s2_dp) :: <A HREF="s2_grf2.html#var_b">b</A>
    real (kind=s2_dp) :: <A HREF="s2_grf2.html#var_c">c</A>
    real (kind=s2_dp) :: <A HREF="s2_grf2.html#var_xr">xr</A>
    real (kind=s2_dp) :: <A HREF="s2_grf2.html#var_yr">yr</A>
    real (kind=s2_dp) :: <A HREF="s2_grf2.html#var_xi">xi</A>
    real (kind=s2_dp) :: <A HREF="s2_grf2.html#var_yi">yi</A>
    type (s2_pl) :: <A HREF="s2_grf2.html#var_a_cl">a_cl</A>
    type (s2_pl) :: <A HREF="s2_grf2.html#var_b_cl">b_cl</A>
    type (s2_pl) :: <A HREF="s2_grf2.html#var_x_cl">x_cl</A>
    real (kind=s2_dp), allocatable, dimension (:) :: <A HREF="s2_grf2.html#var_al">al</A>
    real (kind=s2_dp), allocatable, dimension (:) :: <A HREF="s2_grf2.html#var_bl">bl</A>
    real (kind=s2_dp), allocatable, dimension (:) :: <A HREF="s2_grf2.html#var_xl">xl</A>
    real (kind=s2_sp), allocatable, dimension (:) :: <A HREF="s2_grf2.html#var_al_sp">al_sp</A>
    real (kind=s2_sp), allocatable, dimension (:) :: <A HREF="s2_grf2.html#var_bl_sp">bl_sp</A>
    real (kind=s2_sp), allocatable, dimension (:) :: <A HREF="s2_grf2.html#var_xl_sp">xl_sp</A>
    complex (kind=s2_spc), allocatable, dimension (:,:) :: <A HREF="s2_grf2.html#var_alm">alm</A>
    complex (kind=s2_spc), allocatable, dimension (:,:) :: <A HREF="s2_grf2.html#var_blm">blm</A>
    type (s2_sky) :: <A HREF="s2_grf2.html#var_a_sky">a_sky</A>
    type (s2_sky) :: <A HREF="s2_grf2.html#var_b_sky">b_sky</A>

        ! Subroutines and functions
    subroutine <A HREF="s2_grf2.html#subroutine_parse_options">parse_options</A> ()

end program s2_grf2
</PRE>
 Simulate two Gaussian random fields (GRFs) on the sky that satisfy
 individual and cross power spectra.
<P>
 Notes:
   <UL>
   <LI>  Not tested at all.
<P>
   </UL>
 Usage: s2_grf2
   <UL>
   <LI>  [-help]: Display usage information.
   <LI>  [-inp_al filename_al]: Name of a input ascii file containing power
     spectrum.
   <LI>  [-inp_bl filename_bl]: Name of b input ascii file containing power
     spectrum.
   <LI>  [-inp_xl filename_xl]: Name of x input ascii file containing power
     spectrum.
   <LI>  [-scale_al scale_al]: Logical to specify whether to scale
     the input cl values of al by 2*pi/(l(l+1)).
   <LI>  [-scale_bl scale_bl]: Logical to specify whether to scale
     the input cl values of bl by 2*pi/(l(l+1)).
   <LI>  [-scale_xl scale_xl]: Logical to specify whether to scale
     the input cl values of xl by 2*pi/(l(l+1)).
   <LI>  [-ncomment_al ncomment_al]: Number of comment lines in input a power
     spectrum file to ignore.
   <LI>  [-ncomment_bl ncomment_bl]: Number of comment lines in input b power
     spectrum file to ignore.
   <LI>  [-ncomment_xl ncomment_xl]: Number of comment lines in input x power
     spectrum file to ignore.
   <LI>  [-nside nside]: Healpix nside resolution to generate maps at.
   <LI>  [-lmax lmax]: Maximum hamonic l to consider in power spectrum when
     generating map.
   <LI>  [-lmin lmin]: Minimum l of power spectrum contained in input file
     (others are set to zero).  Often this is 2.
   <LI>  [-seed seed]: Integer seed for random number generator used to
     computed GRFs.  If not specified then use system clock.
   <LI>  [-outa filename_out_a]: Name of sky a output file.
   <LI>  [-outb filename_out_b]: Name of sky b output file.
   <LI>  [-file file_type_str (map or sky)]: Type of output files to write.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 - August 2005

<HR><H2> Description of Variables </H2>
<A NAME="var_map_file"><H3>MAP_FILE</H3></A>
<PRE>character (len=*), parameter :: MAP_FILE = 'map'
</PRE>
<A NAME="var_sky_file"><H3>SKY_FILE</H3></A>
<PRE>character (len=*), parameter :: SKY_FILE = 'sky'
</PRE>
<A NAME="var_file_type_str"><H3>file_type_str</H3></A>
<PRE>character (len=S2_STRING_LEN) :: file_type_str = MAP_FILE
</PRE>
<A NAME="var_filename_out_a"><H3>filename_out_a</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_out_a = 'a.tmp'
</PRE>
<A NAME="var_filename_out_b"><H3>filename_out_b</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_out_b = 'b.tmp'
</PRE>
<A NAME="var_filename_al"><H3>filename_al</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_al
</PRE>
<A NAME="var_filename_bl"><H3>filename_bl</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_bl
</PRE>
<A NAME="var_filename_xl"><H3>filename_xl</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_xl
</PRE>
<A NAME="var_scale_al"><H3>scale_al</H3></A>
<PRE>logical :: scale_al = .false.
</PRE>
<A NAME="var_scale_bl"><H3>scale_bl</H3></A>
<PRE>logical :: scale_bl = .false.
</PRE>
<A NAME="var_scale_xl"><H3>scale_xl</H3></A>
<PRE>logical :: scale_xl = .false.
</PRE>
<A NAME="var_ncomment_al"><H3>ncomment_al</H3></A>
<PRE>integer :: ncomment_al = 0
</PRE>
<A NAME="var_ncomment_bl"><H3>ncomment_bl</H3></A>
<PRE>integer :: ncomment_bl = 0
</PRE>
<A NAME="var_ncomment_xl"><H3>ncomment_xl</H3></A>
<PRE>integer :: ncomment_xl = 0
</PRE>
<A NAME="var_line_nos"><H3>line_nos</H3></A>
<PRE>logical :: line_nos
</PRE>
<A NAME="var_seed"><H3>seed</H3></A>
<PRE>integer :: seed = 0
</PRE>
<A NAME="var_seed_set"><H3>seed_set</H3></A>
<PRE>logical :: seed_set = .false.
</PRE>
<A NAME="var_mean_zero"><H3>MEAN_ZERO</H3></A>
<PRE>real (kind=s2_sp) :: MEAN_ZERO = 0e0
</PRE>
<A NAME="var_std_unit"><H3>STD_UNIT</H3></A>
<PRE>real (kind=s2_sp) :: STD_UNIT = 1e0
</PRE>
<A NAME="var_l"><H3>l</H3></A>
<PRE>integer :: l
</PRE>
<A NAME="var_m"><H3>m</H3></A>
<PRE>integer :: m
</PRE>
<A NAME="var_fail"><H3>fail</H3></A>
<PRE>integer :: fail
</PRE>
<A NAME="var_nside"><H3>nside</H3></A>
<PRE>integer :: nside
</PRE>
<A NAME="var_lmin"><H3>lmin</H3></A>
<PRE>integer :: lmin
</PRE>
<A NAME="var_lmax"><H3>lmax</H3></A>
<PRE>integer :: lmax
</PRE>
<A NAME="var_nside_set"><H3>nside_set</H3></A>
<PRE>logical :: nside_set = .false.
</PRE>
<A NAME="var_a"><H3>a</H3></A>
<PRE>real (kind=s2_dp) :: a
</PRE>
<A NAME="var_b"><H3>b</H3></A>
<PRE>real (kind=s2_dp) :: b
</PRE>
<A NAME="var_c"><H3>c</H3></A>
<PRE>real (kind=s2_dp) :: c
</PRE>
<A NAME="var_xr"><H3>xr</H3></A>
<PRE>real (kind=s2_dp) :: xr
</PRE>
<A NAME="var_yr"><H3>yr</H3></A>
<PRE>real (kind=s2_dp) :: yr
</PRE>
<A NAME="var_xi"><H3>xi</H3></A>
<PRE>real (kind=s2_dp) :: xi
</PRE>
<A NAME="var_yi"><H3>yi</H3></A>
<PRE>real (kind=s2_dp) :: yi
</PRE>
<A NAME="var_a_cl"><H3>a_cl</H3></A>
<PRE>type (s2_pl) :: a_cl
</PRE>
<A NAME="var_b_cl"><H3>b_cl</H3></A>
<PRE>type (s2_pl) :: b_cl
</PRE>
<A NAME="var_x_cl"><H3>x_cl</H3></A>
<PRE>type (s2_pl) :: x_cl
</PRE>
<A NAME="var_al"><H3>al</H3></A>
<PRE>real (kind=s2_dp), allocatable, dimension (:) :: al
</PRE>
<A NAME="var_bl"><H3>bl</H3></A>
<PRE>real (kind=s2_dp), allocatable, dimension (:) :: bl
</PRE>
<A NAME="var_xl"><H3>xl</H3></A>
<PRE>real (kind=s2_dp), allocatable, dimension (:) :: xl
</PRE>
<A NAME="var_al_sp"><H3>al_sp</H3></A>
<PRE>real (kind=s2_sp), allocatable, dimension (:) :: al_sp
</PRE>
<A NAME="var_bl_sp"><H3>bl_sp</H3></A>
<PRE>real (kind=s2_sp), allocatable, dimension (:) :: bl_sp
</PRE>
<A NAME="var_xl_sp"><H3>xl_sp</H3></A>
<PRE>real (kind=s2_sp), allocatable, dimension (:) :: xl_sp
</PRE>
<A NAME="var_alm"><H3>alm</H3></A>
<PRE>complex (kind=s2_spc), allocatable, dimension (:,:) :: alm
</PRE>
<A NAME="var_blm"><H3>blm</H3></A>
<PRE>complex (kind=s2_spc), allocatable, dimension (:,:) :: blm
</PRE>
<A NAME="var_a_sky"><H3>a_sky</H3></A>
<PRE>type (s2_sky) :: a_sky
</PRE>
<A NAME="var_b_sky"><H3>b_sky</H3></A>
<PRE>type (s2_sky) :: b_sky
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_parse_options"><H3>parse_options</H3></A>
<PRE>subroutine parse_options ()
    ! Calls: getArgument
end subroutine parse_options
</PRE>
 Parse the options passed when program called.
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
</HTML>
