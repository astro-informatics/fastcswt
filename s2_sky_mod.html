<HTML>
<HEAD>
   <TITLE> module s2_sky_mod (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Module s2_sky_mod </H1>
<PRE>module s2_sky_mod

        ! Uses
    use <A HREF="s2_types_mod.html">s2_types_mod</A>, only: s2_sp, s2_spc, s2_dp, pi
    use <A HREF="s2_error_mod.html">s2_error_mod</A>
    use <A HREF="s2_vect_mod.html">s2_vect_mod</A>
    use <A HREF="s2_pl_mod.html">s2_pl_mod</A>

        ! Types
    public type <A HREF="s2_sky_mod.html#type_s2_sky">s2_sky</A>

        ! Variables
    integer, public, parameter :: <A HREF="s2_sky_mod.html#var_s2_sky_ring">S2_SKY_RING</A> = 1
    integer, public, parameter :: <A HREF="s2_sky_mod.html#var_s2_sky_nest">S2_SKY_NEST</A> = 2
    integer, public, parameter :: <A HREF="s2_sky_mod.html#var_s2_sky_fun_type_sphere">S2_SKY_FUN_TYPE_SPHERE</A> = 1
    integer, public, parameter :: <A HREF="s2_sky_mod.html#var_s2_sky_fun_type_plane">S2_SKY_FUN_TYPE_PLANE</A> = 2
    integer, public, parameter :: <A HREF="s2_sky_mod.html#var_s2_sky_default_ftype">S2_SKY_DEFAULT_FTYPE</A> = S2_SKY_FUN_TYPE_SPHERE
    integer, public, parameter :: <A HREF="s2_sky_mod.html#var_s2_sky_file_type_map">S2_SKY_FILE_TYPE_MAP</A> = 1
    integer, public, parameter :: <A HREF="s2_sky_mod.html#var_s2_sky_file_type_sky">S2_SKY_FILE_TYPE_SKY</A> = 2
    integer, public, parameter :: <A HREF="s2_sky_mod.html#var_s2_sky_file_type_alm">S2_SKY_FILE_TYPE_ALM</A> = 3

        ! Interfaces
    public interface <A HREF="s2_sky_mod.html#interface_s2_sky_init">s2_sky_init</A>

        ! Subroutines and functions
    private function <A HREF="s2_sky_mod.html#function_s2_sky_init_empty">s2_sky_init_empty</A> (nside, pix_scheme, lmax, mmax) result (sky)
    private function <A HREF="s2_sky_mod.html#function_s2_sky_init_map">s2_sky_init_map</A> (map, nside, pix_scheme, lmax, mmax) result (sky)
    private function <A HREF="s2_sky_mod.html#function_s2_sky_init_alm">s2_sky_init_alm</A> (alm, lmax, mmax, nside, pix_scheme) result (sky)
    private function <A HREF="s2_sky_mod.html#function_s2_sky_init_ab">s2_sky_init_ab</A> (x_ab, interp, nside, pix_scheme, lmax, mmax, sdw) result (sky)
    private function <A HREF="s2_sky_mod.html#function_s2_sky_init_fun">s2_sky_init_fun</A> (fun, nside, pix_scheme, lmax, mmax, param, fun_type_in) result (sky)
    private function <A HREF="s2_sky_mod.html#function_s2_sky_init_file">s2_sky_init_file</A> (filename, file_type, extension) result (sky)
    private function <A HREF="s2_sky_mod.html#function_s2_sky_init_file_map">s2_sky_init_file_map</A> (filename, extension_in) result (sky)
    private function <A HREF="s2_sky_mod.html#function_s2_sky_init_file_alm">s2_sky_init_file_alm</A> (filename) result (sky)
    private function <A HREF="s2_sky_mod.html#function_s2_sky_init_file_sky">s2_sky_init_file_sky</A> (filename) result (sky)
    private function <A HREF="s2_sky_mod.html#function_s2_sky_init_copy">s2_sky_init_copy</A> (orig) result (copy)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_free">s2_sky_free</A> (sky)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_remove_map">s2_sky_remove_map</A> (sky)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_compute_alm">s2_sky_compute_alm</A> (sky, lmax, mmax, message)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_compute_alm_iter">s2_sky_compute_alm_iter</A> (sky, iter_order, lmax, mmax, message)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_compute_map">s2_sky_compute_map</A> (sky, nside, message)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_map_convert">s2_sky_map_convert</A> (sky, pix_scheme)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_conv">s2_sky_conv</A> (sky, beam)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_offset">s2_sky_offset</A> (sky, offset)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_scale">s2_sky_scale</A> (sky, scale)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_add">s2_sky_add</A> (a, b, subtract) result (c)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_product">s2_sky_product</A> (a, b, divide) result (c)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_thres">s2_sky_thres</A> (sky, thres_lower, thres_upper)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_thres_abs">s2_sky_thres_abs</A> (sky, thres)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_error_twonorm">s2_sky_error_twonorm</A> (a, b) result (er)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_rms">s2_sky_rms</A> (a) result (rms)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_dilate">s2_sky_dilate</A> (sky, a, b, norm_preserve)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_rotate">s2_sky_rotate</A> (sky, alpha, beta, gamma)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_power_map">s2_sky_power_map</A> (sky) result (power)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_power_alm">s2_sky_power_alm</A> (sky) result (power)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_azimuthal_bl">s2_sky_azimuthal_bl</A> (sky, cutoff_prop_in) result (mmax_min)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_admiss">s2_sky_admiss</A> (sky) result (admiss)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_admiss_dil">s2_sky_admiss_dil</A> (sky, dilation1, dilation2, admiss, norm_preserve_in)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_extract_ab_fsht">s2_sky_extract_ab_fsht</A> (sky, xtp, L)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_extract_ab">s2_sky_extract_ab</A> (sky, x_ab)
    private function <A HREF="s2_sky_mod.html#function_s2_sky_interp_ab">s2_sky_interp_ab</A> (x_ab, alpha, beta, interp, sdw) result (interp_val)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_downsample">s2_sky_downsample</A> (sky, nside_down, mask)
    private subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_down_nsideby2">s2_sky_down_nsideby2</A> (sky, mask_in)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_upsample">s2_sky_upsample</A> (sky, nside_up)
    private subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_up_nsideby2">s2_sky_up_nsideby2</A> (sky)
    private subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_valid_sizes">s2_sky_valid_sizes</A> (sky)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_draw_dot">s2_sky_draw_dot</A> (sky, alpha, beta, large)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_write_map_file">s2_sky_write_map_file</A> (sky, filename, comment)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_write_alm_file">s2_sky_write_alm_file</A> (sky, filename, comment)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_io_fits_write">s2_sky_io_fits_write</A> (filename, sky, comment)
    private subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_io_fits_read">s2_sky_io_fits_read</A> (filename, sky)
    private subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_io_fits_error_check">s2_sky_io_fits_error_check</A> (status, halt)
    private subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_io_fits_exists">s2_sky_io_fits_exists</A> (filename, status, exists)
    private subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_io_fits_del">s2_sky_io_fits_del</A> (filename, status)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_set_lmax">s2_sky_set_lmax</A> (sky, lmax, mmax_in)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_set_nside">s2_sky_set_nside</A> (sky, nside)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_get_init">s2_sky_get_init</A> (sky) result (init)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_get_nside">s2_sky_get_nside</A> (sky) result (nside)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_get_npix">s2_sky_get_npix</A> (sky) result (npix)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_get_lmax">s2_sky_get_lmax</A> (sky) result (lmax)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_get_mmax">s2_sky_get_mmax</A> (sky) result (mmax)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_get_pix_scheme">s2_sky_get_pix_scheme</A> (sky) result (pix_scheme)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_get_map">s2_sky_get_map</A> (sky, map)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_get_map_pix">s2_sky_get_map_pix</A> (sky, ipix) result (map_pix)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_get_alm">s2_sky_get_alm</A> (sky, alm)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_get_cl">s2_sky_get_cl</A> (sky) result (cl)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_get_cm">s2_sky_get_cm</A> (sky, cm)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_get_map_status">s2_sky_get_map_status</A> (sky) result (map_status)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_get_alm_status">s2_sky_get_alm_status</A> (sky) result (alm_status)
    public function <A HREF="s2_sky_mod.html#function_s2_sky_get_n_param">s2_sky_get_n_param</A> (sky) result (n_param)
    public subroutine <A HREF="s2_sky_mod.html#subroutine_s2_sky_get_param">s2_sky_get_param</A> (sky, param)

end module s2_sky_mod
</PRE>
 Provides functionality to support and manipulate a function defined on 
 the sky(/sphere).  Support is provided to representing the sky in both 
 real (map) space and in harmonic (alm) space, and also to convert between 
 the two representations.  One may also scale, dilate, rotate, downsample 
 and add functions defined on the sky.  The sky pixelisation used is
 currently based on HEALPix.
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 August 2004

<HR><H2> Description of Types </H2>
<A NAME="type_s2_sky"><H3>s2_sky</H3></A>
<PRE>public type s2_sky
    private
    logical :: init = .false.
    integer :: nside = 0
    integer :: npix = 0
    integer :: lmax = 0
    integer :: mmax = 0
    integer :: pix_scheme = S2_SKY_RING
    real (kind=s2_sp), allocatable, dimension (:) :: map
    complex (kind=s2_spc), allocatable, dimension (:,:) :: alm
    logical :: map_status = .false.
    logical :: alm_status = .false.
    real (kind=s2_sp), allocatable, dimension (:) :: param
    integer :: n_param = 0
end type s2_sky
</PRE>

<HR><H2> Description of Variables </H2>
<A NAME="var_s2_sky_ring"><H3>S2_SKY_RING</H3></A>
<PRE>integer, public, parameter :: S2_SKY_RING = 1
</PRE>
 Healpix pixelisation ring type.
<A NAME="var_s2_sky_nest"><H3>S2_SKY_NEST</H3></A>
<PRE>integer, public, parameter :: S2_SKY_NEST = 2
</PRE>
 Healpix pixelisation nest type.
<A NAME="var_s2_sky_fun_type_sphere"><H3>S2_SKY_FUN_TYPE_SPHERE</H3></A>
<PRE>integer, public, parameter :: S2_SKY_FUN_TYPE_SPHERE = 1
</PRE>
 Specifier to indicate function passed to construct sky
 is defined on the sphere.
<A NAME="var_s2_sky_fun_type_plane"><H3>S2_SKY_FUN_TYPE_PLANE</H3></A>
<PRE>integer, public, parameter :: S2_SKY_FUN_TYPE_PLANE = 2
</PRE>
 Specifier to indicate function passed to construct sky
 is defined on the plane (and will be numerically projected onto the 
 sphere).
<A NAME="var_s2_sky_default_ftype"><H3>S2_SKY_DEFAULT_FTYPE</H3></A>
<PRE>integer, public, parameter :: S2_SKY_DEFAULT_FTYPE = S2_SKY_FUN_TYPE_SPHERE
</PRE>
 Default function type if fun_type flag is not specified.
<A NAME="var_s2_sky_file_type_map"><H3>S2_SKY_FILE_TYPE_MAP</H3></A>
<PRE>integer, public, parameter :: S2_SKY_FILE_TYPE_MAP = 1
</PRE>
 Map fits file type.
<A NAME="var_s2_sky_file_type_sky"><H3>S2_SKY_FILE_TYPE_SKY</H3></A>
<PRE>integer, public, parameter :: S2_SKY_FILE_TYPE_SKY = 2
</PRE>
 Full s2_sky file type.
<A NAME="var_s2_sky_file_type_alm"><H3>S2_SKY_FILE_TYPE_ALM</H3></A>
<PRE>integer, public, parameter :: S2_SKY_FILE_TYPE_ALM = 3
</PRE>
 Alm fits file type.

<HR><H2> Description of Interfaces </H2>
<A NAME="interface_s2_sky_init"><H3>s2_sky_init</H3></A>
<PRE>public interface s2_sky_init
    module procedure <A HREF="#function_s2_sky_init_map">s2_sky_init_map</A>
    module procedure <A HREF="#function_s2_sky_init_alm">s2_sky_init_alm</A>
    module procedure <A HREF="#function_s2_sky_init_ab">s2_sky_init_ab</A>
    module procedure <A HREF="#function_s2_sky_init_fun">s2_sky_init_fun</A>
    module procedure <A HREF="#function_s2_sky_init_file">s2_sky_init_file</A>
    module procedure <A HREF="#function_s2_sky_init_copy">s2_sky_init_copy</A>
end interface s2_sky_init
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="function_s2_sky_init_empty"><H3>s2_sky_init_empty</H3></A>
<PRE>private function s2_sky_init_empty (nside, pix_scheme, lmax, mmax) result (sky)
    integer, optional, intent(in) :: nside
    integer, optional, intent(in) :: pix_scheme
    integer, optional, intent(in) :: lmax
    integer, optional, intent(in) :: mmax
    type (s2_sky) :: sky
    ! Calls: s2_error, s2_sky_valid_sizes
end function s2_sky_init_empty
</PRE>
 Initialised an empty sky at a specified resolution.  Neither the map 
 or alm sky representations are allocated.  They are allocated when
 required.
<P>
 Variables:
  <UL>
  <LI>  [nside]: Healpix nside.
  <LI>  [pix_scheme]: Pixelisation scheme for map.
  <LI>  [lmax]: Alm lmax.
  <LI>  [mmax]: Alm lmin.
  <LI>  sky: The returned sky initialised with resolutions.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_init_map"><H3>s2_sky_init_map</H3></A>
<PRE>private function s2_sky_init_map (map, nside, pix_scheme, lmax, mmax) result (sky)
    real (kind=s2_sp), intent(in), dimension (:) :: map
    integer, intent(in) :: nside
    integer, intent(in) :: pix_scheme
    integer, optional, intent(in) :: lmax
    integer, optional, intent(in) :: mmax
    type (s2_sky) :: sky
    ! Calls: s2_error
end function s2_sky_init_map
</PRE>
 Initalise a sky from a specified map.
<P>
 Variables:
  <UL>
  <LI>  map: The map array used to initialised the sky.
  <LI>  nside: Healpix nside.
  <LI>  pix_scheme: Pixelisation scheme for map.  The passed map is assumed 
    to be in this format.
  <LI>  [lmax]: Alm lmax.
  <LI>  [mmax]: Alm mmax.
  <LI>  sky: The returned sky initialised with the specified map.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_init_alm"><H3>s2_sky_init_alm</H3></A>
<PRE>private function s2_sky_init_alm (alm, lmax, mmax, nside, pix_scheme) result (sky)
    complex (kind=s2_spc), intent(in), dimension (:,:) :: alm
    integer, intent(in) :: lmax
    integer, intent(in) :: mmax
    integer, optional, intent(in) :: nside
    integer, optional, intent(in) :: pix_scheme
    type (s2_sky) :: sky
    ! Calls: s2_error
end function s2_sky_init_alm
</PRE>
 Initalise a sky from a specified alm.
<P>
 Variables:
  <UL>
  <LI>  alm: The alm array used to initialised the sky.
  <LI>  lmax: Alm lmax.
  <LI>  mmax: Alm mmax.
  <LI>  [nside]: Healpix nside.
  <LI>  [pix_scheme]: Pixelisation scheme for map.  No map is initialised 
    but if created this will be the default pixelisation scheme.
  <LI>  sky: The returned sky initialised with the specified alm.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_init_ab"><H3>s2_sky_init_ab</H3></A>
<PRE>private function s2_sky_init_ab (x_ab, interp, nside, pix_scheme, lmax, mmax, sdw) result (sky)
    real (kind=s2_sp), intent(in), dimension (:,:) :: x_ab
    logical, intent(in) :: interp
    integer, intent(in) :: nside
    integer, intent(in) :: pix_scheme
    integer, optional, intent(in) :: lmax
    integer, optional, intent(in) :: mmax
    logical, optional, intent(in) :: sdw
    type (s2_sky) :: sky
    ! Calls: pix2ang_nest, pix2ang_ring, s2_error
end function s2_sky_init_ab
</PRE>
 Initialise a sky from the ecp (equi-sampled) alpha-beta array defined on
 the sphere.
<P>
 Notes:
   <UL>
   <LI>  Linear interpolation performed if interp=.true.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  x_ab: Ecp (equi-sampled) alpha-beta array defining a function on 
     the sphere to construct sky from.
   <LI>  interp: Logical specifying whether interpolation is to be performed.
   <LI>  nside: Healpix nside.
   <LI>  pix_scheme: Pixelisation scheme for map. 
   <LI>  [lmax]: Alm lmax.
   <LI>  [mmax]: Alm mmax.
   <LI>  [sdw]: Logical to specify SDW pixelisation.
   <LI>  sky: The returned sky initialised from the ecp (equi-sampled) 
    alpha-beta array defined over the sphere.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_s2_sky_init_fun"><H3>s2_sky_init_fun</H3></A>
<PRE>private function s2_sky_init_fun (fun, nside, pix_scheme, lmax, mmax, param, fun_type_in) result (sky)
    interface fun
        function fun (theta, phi, param) result (val)
            real (kind=s2_sp), intent(in) :: theta
            real (kind=s2_sp), intent(in) :: phi
            real (kind=s2_sp), optional, intent(in), dimension (:) :: param
            real (kind=s2_sp) :: val
        end function fun
    end interface fun
    integer, intent(in) :: nside
    integer, intent(in) :: pix_scheme
    integer, optional, intent(in) :: lmax
    integer, optional, intent(in) :: mmax
    real (kind=s2_sp), optional, intent(in), dimension (:) :: param
    integer, optional, intent(in) :: fun_type_in
    type (s2_sky) :: sky
    ! Calls: pix2ang_nest, pix2ang_ring, s2_error
end function s2_sky_init_fun
</PRE>
 Initialise a sky from a template function.
<P>
 Variables:
  <UL>
  <LI>  nside: Healpix nside.
  <LI>  pix_scheme: Pixelisation scheme for map.  
  <LI>  [lmax]: Alm lmax.
  <LI>  [mmax]: Alm mmax.
  <LI>  [param]: Parameter array specifying analytic parameters for the
    function to be evaluated.
  <LI>  [fun_type_in]: Integer specifing the function type (whether function 
     defined directly on sphere or whether defined on plane and to be 
     numericall projected onto the sphere).
  <LI>  sky: The initialised sky with the template function evaluated over 
    the map.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_init_file"><H3>s2_sky_init_file</H3></A>
<PRE>private function s2_sky_init_file (filename, file_type, extension) result (sky)
    character (len=*), intent(in) :: filename
    integer, intent(in) :: file_type
    integer, optional, intent(in) :: extension
    type (s2_sky) :: sky
    ! Calls: s2_error
end function s2_sky_init_file
</PRE>
 Wrapper to initialise a sky from either a map fits file or a full
 s2_sky fits file.
<P>
 Variables:
  <UL>
  <LI>  filename: The fits filename to read the sky from.
  <LI>  file_type: Fit type specifier to specify whether to read from a 
    fits map file or from a fits full s2_sky file.
  <LI>  [extension]: The fits extension the map to be read is stored in, 
    If not specified the default is 1. 
    (If file_type == S2_SKY_FILE_TYPE_MAP.)
  <LI>  sky: The initialised sky with the map, nside, etc. defined from the
    fits file.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="function_s2_sky_init_file_map"><H3>s2_sky_init_file_map</H3></A>
<PRE>private function s2_sky_init_file_map (filename, extension_in) result (sky)
    character (len=*), intent(in) :: filename
    integer, optional, intent(in) :: extension_in
    type (s2_sky) :: sky
    ! Calls: input_map, s2_error
end function s2_sky_init_file_map
</PRE>
 Initialise a sky from a map file.
<P>
 Variables:
  <UL>
  <LI>  filename: The fits filename to read the map from.
  <LI>  [extension_in]: The fits extension the map to be read is stored in, 
    If not specified the default is 1.
  <LI>  sky: The initialised sky with the map, nside, etc. defined from the
    map contained in the fits file.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_init_file_alm"><H3>s2_sky_init_file_alm</H3></A>
<PRE>private function s2_sky_init_file_alm (filename) result (sky)
    character (len=*), intent(in) :: filename
    type (s2_sky) :: sky
    ! Calls: fits2alms, s2_error
end function s2_sky_init_file_alm
</PRE>
 Initialise a sky from a fits alm file.
<P>
 Variables:
  <UL>
  <LI>  filename: The fits filename to read the alms from.
  <LI>  sky: The initialised sky with the alms, lmax and mmax defined from 
    the alms contained in the fits file.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 November 2005
<A NAME="function_s2_sky_init_file_sky"><H3>s2_sky_init_file_sky</H3></A>
<PRE>private function s2_sky_init_file_sky (filename) result (sky)
    character (len=*), intent(in) :: filename
    type (s2_sky) :: sky
    ! Calls: s2_error, s2_sky_io_fits_read
end function s2_sky_init_file_sky
</PRE>
 Wrapper to initialise a sky data structure from a full s2_sky file.
 The sky structure is read and initialised by the routine 
 s2_sky_io_fits_read.
<P>
 Notes:
   <UL>
   <LI>  Cannot be part of s2_sky_init interface since has same signature
     as s2_sky_init_map_file.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of s2_sky fits file containing the sky data to 
     be read.
   <LI>  sky: Returned sky structure initialised with the data contained in
     the input s2_sky fits file.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005
<A NAME="function_s2_sky_init_copy"><H3>s2_sky_init_copy</H3></A>
<PRE>private function s2_sky_init_copy (orig) result (copy)
    type (s2_sky), intent(in) :: orig
    type (s2_sky) :: copy
    ! Calls: s2_error
end function s2_sky_init_copy
</PRE>
 Initialise a sky as a copy of another sky.
<P>
 Variables:
   <UL>
   <LI>  orig: The original sky to copy.
   <LI>  copy: The initialised map copied from the original.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_free"><H3>s2_sky_free</H3></A>
<PRE>public subroutine s2_sky_free (sky)
    type (s2_sky), intent(inout) :: sky
    ! Calls: s2_error
end subroutine s2_sky_free
</PRE>
 Free all data associated with an initialised sky and reset all other 
 attributes.
<P>
 Variables:
   <UL>
   <LI>  sky: The sky to be freed.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_remove_map"><H3>s2_sky_remove_map</H3></A>
<PRE>public subroutine s2_sky_remove_map (sky)
    type (s2_sky), intent(inout) :: sky
    ! Calls: s2_error
end subroutine s2_sky_remove_map
</PRE>
 Free all data associated with a map and reset all map related 
 attributes.
<P>
 Variables:
   <UL>
   <LI>  sky: The sky containing the map to be removed.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 November 2007
<A NAME="subroutine_s2_sky_compute_alm"><H3>s2_sky_compute_alm</H3></A>
<PRE>public subroutine s2_sky_compute_alm (sky, lmax, mmax, message)
    type (s2_sky), intent(inout) :: sky
    integer, optional, intent(in) :: lmax
    integer, optional, intent(in) :: mmax
    logical, optional, intent(in) :: message
    ! Calls: map2alm, s2_error, s2_sky_map_convert, s2_sky_set_lmax, s2_sky_valid_sizes
end subroutine s2_sky_compute_alm
</PRE>
 Compute the alms for a sky from the map representation.  Errors occur
 if the initialised sky does not have a map defined.
<P>
 Variables:
   <UL>
   <LI>  sky: The sky to compute the alms for.
   <LI>  [lmax]: If specified overwrites the lmax of the sky.
   <LI>  [mmax]: If specified overwrites the mmax of the sky.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_compute_alm_iter"><H3>s2_sky_compute_alm_iter</H3></A>
<PRE>public subroutine s2_sky_compute_alm_iter (sky, iter_order, lmax, mmax, message)
    type (s2_sky), intent(inout) :: sky
    integer, intent(in) :: iter_order
    integer, optional, intent(in) :: lmax
    integer, optional, intent(in) :: mmax
    logical, optional, intent(in) :: message
    ! Calls: alm2map, map2alm, s2_error, s2_sky_map_convert, s2_sky_set_lmax, s2_sky_valid_sizes
end subroutine s2_sky_compute_alm_iter
</PRE>
 Compute the alms for a sky from the map representation using iteration.
 Errors occur if the initialised sky does not have a map defined.
<P>
 Variables:
   <UL>
   <LI>  sky: The sky to compute the alms for.
   <LI>  iter_order: Number of iterations to perform (iter_order=0 gives 
     same results as s2_sky_compute_alm
   <LI>  [lmax]: If specified overwrites the lmax of the sky.
   <LI>  [mmax]: If specified overwrites the mmax of the sky.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 November 2007
<A NAME="subroutine_s2_sky_compute_map"><H3>s2_sky_compute_map</H3></A>
<PRE>public subroutine s2_sky_compute_map (sky, nside, message)
    type (s2_sky), intent(inout) :: sky
    integer, optional, intent(in) :: nside
    logical, optional, intent(in) :: message
    ! Calls: alm2map, s2_error, s2_sky_set_nside, s2_sky_valid_sizes
end subroutine s2_sky_compute_map
</PRE>
 Compute the map for a sky from the alm representation.  Errors occur
 if the initialised sky does not have an alm defined.
<P>
 Variables:
   <UL>
   <LI>  sky: The sky to compute the map for.
   <LI>  [nside]: If specified overwrites the nside of the sky.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_map_convert"><H3>s2_sky_map_convert</H3></A>
<PRE>public subroutine s2_sky_map_convert (sky, pix_scheme)
    type (s2_sky), intent(inout) :: sky
    integer, intent(in) :: pix_scheme
    ! Calls: convert_nest2ring, convert_ring2nest, s2_error
end subroutine s2_sky_map_convert
</PRE>
 Convert the map pixelisation scheme to that specified.  If the map is
 already in the required pixelisation scheme then do nothing.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky to convert pixelisation scheme.
   <LI>  pix_scheme: Required pixelisation scheme.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_conv"><H3>s2_sky_conv</H3></A>
<PRE>public subroutine s2_sky_conv (sky, beam)
    type (s2_sky), intent(inout) :: sky
    type (s2_pl), intent(in) :: beam
    ! Calls: s2_error, s2_pl_conv, s2_sky_compute_map
end subroutine s2_sky_conv
</PRE>
 Convolve a sky with a beam.
<P>
 Notes:
   <UL>
   <LI>  Sky alms must already be defined since if not lmax and mmax may not
     be defined.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  sky: Sky to convolve with beam.  Convolved sky on ouput.
   <LI>  beam: Beam to convolve with sky.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 May 2005
<A NAME="subroutine_s2_sky_offset"><H3>s2_sky_offset</H3></A>
<PRE>public subroutine s2_sky_offset (sky, offset)
    type (s2_sky), intent(inout) :: sky
    real (kind=s2_sp), intent(in) :: offset
    ! Calls: s2_error, s2_sky_compute_alm, s2_sky_compute_map
end subroutine s2_sky_offset
</PRE>
 Add an offset to the sky.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky to add offset to.
   <LI>  offset: Offset to add.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 June 2006
<A NAME="subroutine_s2_sky_scale"><H3>s2_sky_scale</H3></A>
<PRE>public subroutine s2_sky_scale (sky, scale)
    type (s2_sky), intent(inout) :: sky
    real (kind=s2_sp), intent(in) :: scale
    ! Calls: s2_error
end subroutine s2_sky_scale
</PRE>
 Scale both the sky map and alm.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky to scale.
   <LI>  scale: Scale to apply
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_add"><H3>s2_sky_add</H3></A>
<PRE>public function s2_sky_add (a, b, subtract) result (c)
    type (s2_sky), intent(inout) :: a
    type (s2_sky), intent(inout) :: b
    logical, optional, intent(in) :: subtract
    type (s2_sky) :: c
    ! Calls: s2_error, s2_sky_compute_map, s2_sky_map_convert
end function s2_sky_add
</PRE>
 Add the maps of two skys.  
<P>
 Variables:
  <UL>
  <LI>  a: First sky to be added.
  <LI>  b: Second sky to be added
  <LI>  [subtract]: Logcal specifying whether to subtract, rather than 
    add maps.
  <LI>  c: The output <STRONG>initialised</STRONG> sky whos map is the sum of the maps of 
    the other two passed skies.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_product"><H3>s2_sky_product</H3></A>
<PRE>public function s2_sky_product (a, b, divide) result (c)
    type (s2_sky), intent(inout) :: a
    type (s2_sky), intent(inout) :: b
    logical, optional, intent(in) :: divide
    type (s2_sky) :: c
    ! Calls: s2_error, s2_sky_compute_map, s2_sky_map_convert
end function s2_sky_product
</PRE>
 Multiply two sky maps together.
<P>
 Variables:
  <UL>
  <LI>  a: First sky.
  <LI>  b: Second sky.
  <LI>  [divide]: Logcal specifying whether to dive, rather than 
    multiply maps (if so result is a/b).
  <LI>  c: The output <STRONG>initialised</STRONG> sky whos map is the product of the maps
    of the other two passed skies.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2005
<A NAME="subroutine_s2_sky_thres"><H3>s2_sky_thres</H3></A>
<PRE>public subroutine s2_sky_thres (sky, thres_lower, thres_upper)
    type (s2_sky), intent(inout) :: sky
    real (kind=s2_sp), intent(in) :: thres_lower
    real (kind=s2_sp), intent(in) :: thres_upper
    ! Calls: s2_error, s2_sky_compute_alm, s2_sky_compute_map
end subroutine s2_sky_thres
</PRE>
 Threshold all values outside range to specified limits.
<P>
 Variables:
  <UL>
  <LI>  sky: Sky to threshold.
  <LI>  thres_lower: Lower threshold value.
  <LI>  thres_upper: Upper threshold value.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2007
<A NAME="subroutine_s2_sky_thres_abs"><H3>s2_sky_thres_abs</H3></A>
<PRE>public subroutine s2_sky_thres_abs (sky, thres)
    type (s2_sky), intent(inout) :: sky
    real (kind=s2_sp), intent(in) :: thres
    ! Calls: s2_error, s2_sky_compute_alm, s2_sky_compute_map
end subroutine s2_sky_thres_abs
</PRE>
 Threshold all values below (in absolute value) specified threshold.
<P>
 Variables:
  <UL>
  <LI>  sky: Sky to threshold.
  <LI>  thres: Threshold value.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2007
<A NAME="function_s2_sky_error_twonorm"><H3>s2_sky_error_twonorm</H3></A>
<PRE>public function s2_sky_error_twonorm (a, b) result (er)
    type (s2_sky), intent(inout) :: a
    type (s2_sky), intent(inout) :: b
    real (kind=s2_sp) :: er
    ! Calls: s2_error, s2_sky_compute_map, s2_sky_map_convert
end function s2_sky_error_twonorm
</PRE>
 Compute two-norm error (i.e. mean square error) or two sky maps.
<P>
 Variables:
  <UL>
  <LI>  a: First sky.
  <LI>  b: Second sky.
  <LI>  error: Two-norm error computed by 
    er = sqrt( int( (a(w)-b(w))^2 )dw ).
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2007
<A NAME="function_s2_sky_rms"><H3>s2_sky_rms</H3></A>
<PRE>public function s2_sky_rms (a) result (rms)
    type (s2_sky), intent(inout) :: a
    real (kind=s2_sp) :: rms
    ! Calls: s2_error, s2_sky_compute_map
end function s2_sky_rms
</PRE>
 Compute root-mean squared value of sky (same as error_twonorm with 
 second sky set to zero).
<P>
 Variables:
  <UL>
  <LI>  a: Sky to compute RMS value of.
  <LI>  rms: RMS value of sky computed by 
    er = sqrt( int( (a(w))^2 )dw ).
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2007
<A NAME="subroutine_s2_sky_dilate"><H3>s2_sky_dilate</H3></A>
<PRE>public subroutine s2_sky_dilate (sky, a, b, norm_preserve)
    type (s2_sky), intent(inout) :: sky
    real (kind=s2_sp), intent(in) :: a
    real (kind=s2_sp), intent(in) :: b
    logical, intent(in) :: norm_preserve
    ! Calls: ang2pix_nest, ang2pix_ring, pix2ang_nest, pix2ang_ring, s2_error
end subroutine s2_sky_dilate
</PRE>
 Dilate the map of a sky.  The dilation may be performed in two 
 orthogonal directions.  To perform the usual isotropic dilation set
 a=b.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky to dilate. 
   <LI>  a: First dilation scale.
   <LI>  b: Second dilation scale.
   <LI>  norm_preserve: Logical specifying whether a norm preserving 
     `cocycle' factor is to be applied.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_rotate"><H3>s2_sky_rotate</H3></A>
<PRE>public subroutine s2_sky_rotate (sky, alpha, beta, gamma)
    type (s2_sky), intent(inout) :: sky
    real (kind=s2_sp) :: alpha
    real (kind=s2_sp) :: beta
    real (kind=s2_sp) :: gamma
    ! Calls: ang2pix_nest, ang2pix_ring, pix2ang_nest, pix2ang_ring, s2_error, s2_vect_free, s2_vect_rotate
end subroutine s2_sky_rotate
</PRE>
 Rotate the map of a sky.  The rotation is perform in real space.
 The rotation is defined by the rotation routine in the s2_vect_mod
 class.
<P>
 Variables
  <UL>
  <LI>  sky: The sky rotated.
  <LI>  alpha: Alpha Euler angle of the rotation.
  <LI>  beta: Beta Euler angle of the rotation.
  <LI>  gamma: Gamma Euler angle of the rotation.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_power_map"><H3>s2_sky_power_map</H3></A>
<PRE>public function s2_sky_power_map (sky) result (power)
    type (s2_sky), intent(in) :: sky
    real (kind=s2_sp) :: power
    ! Calls: s2_error
end function s2_sky_power_map
</PRE>
 Compute power of function on sphere in map space.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky to compute power of.
   <LI>  power: Full power computed.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 May 2006
<A NAME="function_s2_sky_power_alm"><H3>s2_sky_power_alm</H3></A>
<PRE>public function s2_sky_power_alm (sky) result (power)
    type (s2_sky), intent(in) :: sky
    real (kind=s2_sp) :: power
    ! Calls: s2_error, s2_pl_free
end function s2_sky_power_alm
</PRE>
 Compute power of function on sphere in alm space.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky to compute power of.
   <LI>  power: Full power computed.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 May 2006
<A NAME="function_s2_sky_azimuthal_bl"><H3>s2_sky_azimuthal_bl</H3></A>
<PRE>public function s2_sky_azimuthal_bl (sky, cutoff_prop_in) result (mmax_min)
    type (s2_sky), intent(in) :: sky
    real (kind=s2_sp), optional, intent(in) :: cutoff_prop_in
    integer :: mmax_min
    ! Calls: s2_error, s2_pl_free, s2_pl_get_spec, s2_sky_get_cm
end function s2_sky_azimuthal_bl
</PRE>
 Find azimuthal band limit of sky.  Finds lowest m' value such that 
 cutoff_prop*100 percent of the cm power is contained in the alms 
 with m index below m'.
<P>
 Notes:
   <UL>
   <LI>  Only successful if alms for the sky are already computed.  Cannot 
     mmax may not be defined.
<P>
   </UL>
 Variables
  <UL>
  <LI>  sky: Sky to find azimuthal band limit for.
  <LI>  [cutoff_prop_in]: Cutoff proportion to use when finding azimuthal 
    band limit.  If not specified default value is used.
  <LI>  mmax_min: The azimuthal band limit found.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 May 2005
<A NAME="function_s2_sky_admiss"><H3>s2_sky_admiss</H3></A>
<PRE>public function s2_sky_admiss (sky) result (admiss)
    type (s2_sky), intent(in) :: sky
    real (kind=s2_sp) :: admiss
    ! Calls: pix2ang_nest, pix2ang_ring, s2_error
end function s2_sky_admiss
</PRE>
 Calculte the normalised numerical admissibility of a wavelet defined 
 on the sphere.
<P>
 Notes:
   <UL>
   <LI>  To developers: Have a consistent area element in every term of
     discretised integral thus it cancels and may be removed.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  sky: Sky to calculate wavelet admissibility of.
   <LI>  admiss: Normalised numerical admissibility value calculated.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_admiss_dil"><H3>s2_sky_admiss_dil</H3></A>
<PRE>public subroutine s2_sky_admiss_dil (sky, dilation1, dilation2, admiss, norm_preserve_in)
    type (s2_sky), intent(in) :: sky
    real (kind=s2_sp), intent(in), dimension (:) :: dilation1
    real (kind=s2_sp), intent(in), dimension (:) :: dilation2
    real (kind=s2_sp), intent(out), dimension (:) :: admiss
    logical, optional, intent(in) :: norm_preserve_in
    ! Calls: s2_error, s2_sky_dilate, s2_sky_free
end subroutine s2_sky_admiss_dil
</PRE>
 Compute admissibility for function defined on sphere for a range of
 dilations.
<P>
 Variables:
   <UL>
   <LI>  sky: Original (undilated) sky to calculated dilations of.
   <LI>  dilation1: Array of first dilation components.
   <LI>  dilation2: Array of second dilation components.
   <LI>  admiss: Array of admissibility values calculated corresponding to
     the dilated version of the passed function defined on the sphere.
   <LI>  [norm_preserve_in]: Logical to specify whether dilations are to 
     preserve the 2-norm.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_s2_sky_extract_ab_fsht"><H3>s2_sky_extract_ab_fsht</H3></A>
<PRE>public subroutine s2_sky_extract_ab_fsht (sky, xtp, L)
    type (s2_sky), intent(in) :: sky
    real (kind=s2_sp), intent(out), dimension (0:L,0:2*L) :: xtp
    integer, intent(in) :: L
    ! Calls: ang2pix_nest, ang2pix_ring, s2_error
end subroutine s2_sky_extract_ab_fsht
</PRE>
 Extra an ecp (equispaced) sampled theta-phi array over the sphere
 for the grid used for the Fast Spherical Harmonic Transform.
<P>
 Notes:
   <UL>
   <LI>  No interpolation performed.
   <LI>  The size of xtp must already be specified and allocated.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  sky: Sky to extract theta-phi array representation of.
   <LI>  xtp: The extracted discrete theta-phi data array corresponding
     to the given sky.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2008
<A NAME="subroutine_s2_sky_extract_ab"><H3>s2_sky_extract_ab</H3></A>
<PRE>public subroutine s2_sky_extract_ab (sky, x_ab)
    type (s2_sky), intent(in) :: sky
    real (kind=s2_sp), intent(out), dimension (:,:) :: x_ab
    ! Calls: ang2pix_nest, ang2pix_ring, s2_error
end subroutine s2_sky_extract_ab
</PRE>
 Extra an ecp (equispaced) sampled alpha-beta array over the sphere
 corresponding to the given sky.
<P>
 Notes:
   <UL>
   <LI>  No interpolation performed.
   <LI>  The size of x_ab must already be specified and allocated.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  sky: Sky to extract alpha-beta array representation of.
   <LI>  x_ab: The extracted discrete alpha-beta data array corresponding
     to the given sky.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_s2_sky_interp_ab"><H3>s2_sky_interp_ab</H3></A>
<PRE>private function s2_sky_interp_ab (x_ab, alpha, beta, interp, sdw) result (interp_val)
    real (kind=s2_sp), intent(in), dimension (:,:) :: x_ab
    real (kind=s2_dp), intent(inout) :: alpha
    real (kind=s2_dp), intent(inout) :: beta
    logical, intent(in) :: interp
    logical, optional, intent(in) :: sdw
    real (kind=s2_sp) :: interp_val
end function s2_sky_interp_ab
</PRE>
 Interpolate a pixelised ab array for any continuous value 
 in the appropriate angle ranges.
<P>
 Notes:
   <UL>
   <LI>  Linear interpolation used.
   <LI>  Angles outside the valid range for alpha [0,2*pi] and
     beta [0,pi] are mapped onto the mod of 
     the angle for the relevant range.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  x_ab: The discrete ab data array to be
     interpolated. 
   <LI>  alpha: The alpha continuous angle to interpolate at.
   <LI>  beta: The beta continuous angle to interpolate at.
   <LI>  interp: Logical to specify whether interpolation is to be 
     performed.  If not, then the nearest (lower) sample is simply taken.
   <LI>  [sdw]: Logical to specify SDW pixelisation.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_s2_sky_downsample"><H3>s2_sky_downsample</H3></A>
<PRE>public subroutine s2_sky_downsample (sky, nside_down, mask)
    type (s2_sky), intent(inout) :: sky
    integer, intent(in) :: nside_down
    logical, optional, intent(in) :: mask
    ! Calls: s2_error, s2_sky_down_nsideby2
end subroutine s2_sky_downsample
</PRE>
 Downsample a sky map nside to the specified (lower!) nside.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky to be downsampled. 
   <LI>  nside_down: The new nside of the downsampled sky.
   <LI>  mask: Logical specifying whether sky to downsample is a mask 
     (in which case pixels are multiplied to downsample rather than
     averaged).
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_down_nsideby2"><H3>s2_sky_down_nsideby2</H3></A>
<PRE>private subroutine s2_sky_down_nsideby2 (sky, mask_in)
    type (s2_sky), intent(inout) :: sky
    logical, optional, intent(in) :: mask_in
    ! Calls: s2_error, s2_sky_map_convert
end subroutine s2_sky_down_nsideby2
</PRE>
 Downsample a sky map nside by a factor of two.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky to be downsampled. 
   <LI>  mask_in: Logical specifying whether sky to downsample is a mask 
     (in which case pixels are multiplied to downsample rather than
     averaged).
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_upsample"><H3>s2_sky_upsample</H3></A>
<PRE>public subroutine s2_sky_upsample (sky, nside_up)
    type (s2_sky), intent(inout) :: sky
    integer, intent(in) :: nside_up
    ! Calls: s2_error, s2_sky_up_nsideby2
end subroutine s2_sky_upsample
</PRE>
 Up-sample a sky map nside to the specified (greater!) nside.
 Map is up-sampled by simply setting all sub pixels in a nested region
 to the value of the parent pixel).
<P>
 Variables:
   <UL>
   <LI>  sky: Sky to be upsampled.
   <LI>  nside_down: The new nside of the downsampled sky.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2005
<A NAME="subroutine_s2_sky_up_nsideby2"><H3>s2_sky_up_nsideby2</H3></A>
<PRE>private subroutine s2_sky_up_nsideby2 (sky)
    type (s2_sky), intent(inout) :: sky
    ! Calls: s2_error, s2_sky_map_convert
end subroutine s2_sky_up_nsideby2
</PRE>
 Up-sample a sky map nside by a factor of two (simply set all sub
 pixels in a nested region to the value of the parent pixel).
<P>
 Variables:
   <UL>
   <LI>  sky: Sky to be up-sampled.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2005
<A NAME="subroutine_s2_sky_valid_sizes"><H3>s2_sky_valid_sizes</H3></A>
<PRE>private subroutine s2_sky_valid_sizes (sky)
    type (s2_sky), intent(in) :: sky
    ! Calls: s2_error
end subroutine s2_sky_valid_sizes
</PRE>
 Check the nside, lmax and mmax resolutions are valid.  Invalid if any
 are negative.  Also warning given if lmax > 3*nside of mmax < lmax
<P>
 Variables:
   <UL>
   <LI>  sky: Sky to check sizes of.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_draw_dot"><H3>s2_sky_draw_dot</H3></A>
<PRE>public subroutine s2_sky_draw_dot (sky, alpha, beta, large)
    type (s2_sky), intent(inout) :: sky
    real (kind=s2_sp), intent(in), dimension (:) :: alpha
    real (kind=s2_sp), intent(in), dimension (:) :: beta
    logical, optional, intent(in) :: large
    ! Calls: ang2pix_nest, neighbours_nest, s2_error, s2_sky_map_convert
end subroutine s2_sky_draw_dot
</PRE>
 Draw dots on sky map at specified positions.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky to draw dots on map of.
   <LI>  alpha: Alpha array of dot positions.
   <LI>  beta: Beta array of dot positions.  (Must have same size as alpha 
     array.)
   <LI>  [large]: Logical to indicate whether to draw large dots.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_write_map_file"><H3>s2_sky_write_map_file</H3></A>
<PRE>public subroutine s2_sky_write_map_file (sky, filename, comment)
    type (s2_sky), intent(in) :: sky
    character (len=*), intent(in) :: filename
    character (len=*), optional, intent(in) :: comment
    ! Calls: add_card, s2_error, write_bintab
end subroutine s2_sky_write_map_file
</PRE>
 Write a sky map to a fits file.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky containing the map to write to a fits file.
   <LI>  filename: Name of the output fits file.
   <LI>  [comment]: Optional additional comment to be added to the fits file
     header.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_write_alm_file"><H3>s2_sky_write_alm_file</H3></A>
<PRE>public subroutine s2_sky_write_alm_file (sky, filename, comment)
    type (s2_sky), intent(in) :: sky
    character (len=*), intent(in) :: filename
    character (len=*), optional, intent(in) :: comment
    ! Calls: add_card, alms2fits, s2_error
end subroutine s2_sky_write_alm_file
</PRE>
 Write sky alms to a fits file.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky containing the alm to write to a fits file.
   <LI>  filename: Name of the output fits file.
   <LI>  [comment]: Optional additional comment to be added to the fits file
     header.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 November 2005
<A NAME="subroutine_s2_sky_io_fits_write"><H3>s2_sky_io_fits_write</H3></A>
<PRE>public subroutine s2_sky_io_fits_write (filename, sky, comment)
    character (len=*), intent(in) :: filename
    type (s2_sky), intent(in) :: sky
    character (len=*), optional, intent(in) :: comment
    ! Calls: ftclos, ftfiou, ftgiou, ftibin, ftiimg, ftinit, ftp2de, ftpcle, ftpcom, ftpdat, ftphpr, ftpkyj, ftpkyl, ftpkys, s2_error, s2_sky_io_fits_error_check, s2_sky_io_fits_exists
end subroutine s2_sky_io_fits_write
</PRE>
 Write a s2_sky object to a fits file.  All s2_sky data is writtend to
 the file (i.e. both the map and alms are written if present, as well as
 any sky function parameters and all other s2_sky variables.
<P>
 Variables:
   <UL>
   <LI>  filename: Name of the output fits file to write the sky structure
     data to.
   <LI>  sky: The sky structure containing the data to be written to the
     output fits file.
   <LI>  [comment]: Optional comment string to be added to the output fits 
     file header if present.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005
<A NAME="subroutine_s2_sky_io_fits_read"><H3>s2_sky_io_fits_read</H3></A>
<PRE>private subroutine s2_sky_io_fits_read (filename, sky)
    character (len=*), intent(in) :: filename
    type (s2_sky), intent(out) :: sky
    ! Calls: ftclos, ftfiou, ftg2de, ftgcve, ftgiou, ftgkyj, ftgkyl, ftmahd, ftopen, ftthdu, s2_error, s2_sky_io_fits_error_check, s2_sky_io_fits_exists
end subroutine s2_sky_io_fits_read
</PRE>
 Reads a full s2_sky fits file and allocates a new sky structure with
 the data read.
<P>
 Variables:
   <UL>
   <LI>  filename: Name of s2_sky fits file containing the sky data to 
     be read.
   <LI>  sky: Returned sky structure initialised with the data contained in
     the input s2_sky fits file.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005
<A NAME="subroutine_s2_sky_io_fits_error_check"><H3>s2_sky_io_fits_error_check</H3></A>
<PRE>private subroutine s2_sky_io_fits_error_check (status, halt)
    integer, intent(inout) :: status
    logical, intent(in) :: halt
    ! Calls: ftgerr, ftgmsg
end subroutine s2_sky_io_fits_error_check
</PRE>
 Check if a fits error has occured and print error message.  Halt
 program execution if halt flag is set.
<P>
 Notes:
   <UL>
   <LI>  Copied form cswt_tr_mod module.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  status: Fits integer status code.
   <LI>  halt: Logical to indicate whether to halt program execution if an 
     error is detected.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_s2_sky_io_fits_exists"><H3>s2_sky_io_fits_exists</H3></A>
<PRE>private subroutine s2_sky_io_fits_exists (filename, status, exists)
    character (len=*), intent(in) :: filename
    integer, intent(inout) :: status
    logical, intent(out) :: exists
    ! Calls: ftclos, ftfiou, ftgiou, ftopen, s2_sky_io_fits_error_check
end subroutine s2_sky_io_fits_exists
</PRE>
 Check if a fits file exists.
<P>
 Notes:
   <UL>
   <LI>  Copied form cswt_tr_mod module.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of fits file to check existence of.
   <LI>  status: Fits integer status code.
   <LI>  exists: Logical indicating whether the fits file already exists.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_s2_sky_io_fits_del"><H3>s2_sky_io_fits_del</H3></A>
<PRE>private subroutine s2_sky_io_fits_del (filename, status)
    character (len=*), intent(in) :: filename
    integer, intent(inout) :: status
    ! Calls: ftcmsg, ftdelt, ftfiou, ftgiou, ftopen
end subroutine s2_sky_io_fits_del
</PRE>
 Delete a fits file.
<P>
 Notes:
   <UL>
   <LI>  Copied form cswt_tr_mod module.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of fits file to detele.
   <LI>  status: Fits integer status code.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_s2_sky_set_lmax"><H3>s2_sky_set_lmax</H3></A>
<PRE>public subroutine s2_sky_set_lmax (sky, lmax, mmax_in)
    type (s2_sky), intent(inout) :: sky
    integer, intent(in) :: lmax
    integer, optional, intent(in) :: mmax_in
    ! Calls: s2_sky_valid_sizes
end subroutine s2_sky_set_lmax
</PRE>
 Set a sky lmax.  If alm is calculated it is removed.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky to set lmax of.
   <LI>  lmax: New lmax to set.
   <LI>  [mmax_in]: New mmax to set.  If not specified defaults to new lmax.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_set_nside"><H3>s2_sky_set_nside</H3></A>
<PRE>public subroutine s2_sky_set_nside (sky, nside)
    type (s2_sky), intent(inout) :: sky
    integer, intent(in) :: nside
    ! Calls: s2_sky_valid_sizes
end subroutine s2_sky_set_nside
</PRE>
 Set a sky nside.  If map is calculated it is removed.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky to set nside of.
   <LI>  nside: New nside to set.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_get_init"><H3>s2_sky_get_init</H3></A>
<PRE>public function s2_sky_get_init (sky) result (init)
    type (s2_sky), intent(in) :: sky
    logical :: init
end function s2_sky_get_init
</PRE>
 Get init variable from the passed sky.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky object to get the variable of.
   <LI>  init: Object init variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_get_nside"><H3>s2_sky_get_nside</H3></A>
<PRE>public function s2_sky_get_nside (sky) result (nside)
    type (s2_sky), intent(in) :: sky
    integer :: nside
    ! Calls: s2_error
end function s2_sky_get_nside
</PRE>
 Get nside variable from the passed sky.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky object to get the variable of.
   <LI>  nside: Object nside variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_get_npix"><H3>s2_sky_get_npix</H3></A>
<PRE>public function s2_sky_get_npix (sky) result (npix)
    type (s2_sky), intent(in) :: sky
    integer :: npix
    ! Calls: s2_error
end function s2_sky_get_npix
</PRE>
 Get nside variable from the passed sky.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky object to get the variable of.
   <LI>  npix: Object npix variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_get_lmax"><H3>s2_sky_get_lmax</H3></A>
<PRE>public function s2_sky_get_lmax (sky) result (lmax)
    type (s2_sky), intent(in) :: sky
    integer :: lmax
    ! Calls: s2_error
end function s2_sky_get_lmax
</PRE>
 Get lmax variable from the passed sky.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky object to get the variable of.
   <LI>  lmax: Object lmax variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_get_mmax"><H3>s2_sky_get_mmax</H3></A>
<PRE>public function s2_sky_get_mmax (sky) result (mmax)
    type (s2_sky), intent(in) :: sky
    integer :: mmax
    ! Calls: s2_error
end function s2_sky_get_mmax
</PRE>
 Get mmax variable from the passed sky.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky object to get the variable of.
   <LI>  mmax: Object mmax variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_get_pix_scheme"><H3>s2_sky_get_pix_scheme</H3></A>
<PRE>public function s2_sky_get_pix_scheme (sky) result (pix_scheme)
    type (s2_sky), intent(in) :: sky
    integer :: pix_scheme
    ! Calls: s2_error
end function s2_sky_get_pix_scheme
</PRE>
 Get pix_scheme variable from the passed sky.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky object to get the variable of.
   <LI>  pix_scheme: Object pix_scheme variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_get_map"><H3>s2_sky_get_map</H3></A>
<PRE>public subroutine s2_sky_get_map (sky, map)
    type (s2_sky), intent(in) :: sky
    real (kind=s2_sp), intent(out), dimension (:) :: map
    ! Calls: s2_error
end subroutine s2_sky_get_map
</PRE>
 Get map variable from the passed sky.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky object to get the variable of.
   <LI>  map(:): Object map variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_get_map_pix"><H3>s2_sky_get_map_pix</H3></A>
<PRE>public function s2_sky_get_map_pix (sky, ipix) result (map_pix)
    type (s2_sky), intent(in) :: sky
    integer, intent(in) :: ipix
    real (kind=s2_sp) :: map_pix
    ! Calls: s2_error
end function s2_sky_get_map_pix
</PRE>
 Get map pixel from the passed sky.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky object to get the variable of.
   <LI>  map_pix: Object map pixel variable returned.
   <LI>  ipix: The index of the pixel to get (in range [0:sky%npix-1]).
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_s2_sky_get_alm"><H3>s2_sky_get_alm</H3></A>
<PRE>public subroutine s2_sky_get_alm (sky, alm)
    type (s2_sky), intent(in) :: sky
    complex (kind=s2_spc), intent(out), dimension (:,:) :: alm
    ! Calls: s2_error
end subroutine s2_sky_get_alm
</PRE>
 Get alm variable from the passed sky.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky object to get the variable of.
   <LI>  alm(:,:): Object alm variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_get_cl"><H3>s2_sky_get_cl</H3></A>
<PRE>public function s2_sky_get_cl (sky) result (cl)
    type (s2_sky), intent(in) :: sky
    type (s2_pl) :: cl
    ! Calls: s2_error
end function s2_sky_get_cl
</PRE>
 Compute cl for the given sky.  
<P>
 Notes:
   <UL>
   <LI>  Only successful if alms for the sky are already computed.  Cannot 
     mmax may not be defined.
   <LI>  Initialses a new pl object which must be freed by calling routine.
   <LI>  Map assumed real (thus alms only stored from m>=0) hence cl computed
     by: cl = 1/(2*l+1) * ( |a_{l,0}|^2 + 2 * \sum_{m=1}^l |a_{l,m}|^2 )
<P>
   </UL>
 Variables:
   <UL>
   <LI>  sky: Sky object to get the variable of.
   <LI>  cl: Cls computed for the sky.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="subroutine_s2_sky_get_cm"><H3>s2_sky_get_cm</H3></A>
<PRE>public subroutine s2_sky_get_cm (sky, cm)
    type (s2_sky), intent(in) :: sky
    real (kind=s2_sp), intent(out), dimension (0:) :: cm
    ! Calls: s2_error
end subroutine s2_sky_get_cm
</PRE>
 Compute cm for the given sky.  
<P>
 Notes:
   <UL>
   <LI>  Only successful if alms for the sky are already computed.  Cannot 
     mmax may not be defined.
   <LI>  Map assumed real (thus alms only stored from m>=0) hence cm computed
     by: cm = 1/(2*(lmax-m)+2-dm0) 
            * \sum_{l=m}^lmax [ 2*(1-dm0)*|a_{l,m}|^2 + dm0*|a_{l,0}|^2 ]
     where dm0 is the Kronecker delta.
   <LI>  Predominately used for determined azimuthal band limit of a sky.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  sky: Sky object to get the variable of.
   <LI>  cm: Cms computed for the sky.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="function_s2_sky_get_map_status"><H3>s2_sky_get_map_status</H3></A>
<PRE>public function s2_sky_get_map_status (sky) result (map_status)
    type (s2_sky), intent(in) :: sky
    logical :: map_status
    ! Calls: s2_error
end function s2_sky_get_map_status
</PRE>
 Get map_status variable from the passed sky.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky object to get the variable of.
   <LI>  map_status: Object map_status variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_get_alm_status"><H3>s2_sky_get_alm_status</H3></A>
<PRE>public function s2_sky_get_alm_status (sky) result (alm_status)
    type (s2_sky), intent(in) :: sky
    logical :: alm_status
    ! Calls: s2_error
end function s2_sky_get_alm_status
</PRE>
 Get map_status variable from the passed sky.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky object to get variable of.
   <LI>  alm_status: Object alm_status variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_s2_sky_get_n_param"><H3>s2_sky_get_n_param</H3></A>
<PRE>public function s2_sky_get_n_param (sky) result (n_param)
    type (s2_sky), intent(in) :: sky
    integer :: n_param
    ! Calls: s2_error
end function s2_sky_get_n_param
</PRE>
 Get n_param variable from the passed sky.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky object to get variable of.
   <LI>  n_param: Object n_param variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 November 2004
<A NAME="subroutine_s2_sky_get_param"><H3>s2_sky_get_param</H3></A>
<PRE>public subroutine s2_sky_get_param (sky, param)
    type (s2_sky), intent(in) :: sky
    real (kind=s2_sp), intent(out), dimension (:) :: param
    ! Calls: s2_error
end subroutine s2_sky_get_param
</PRE>
 Get param variable from the passed sky.
<P>
 Variables:
   <UL>
   <LI>  sky: Sky object to get the variable of.
   <LI>  param(:): Object param variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 November 2004
</HTML>
