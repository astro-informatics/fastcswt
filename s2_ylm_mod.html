<HTML>
<HEAD>
   <TITLE> module s2_ylm_mod (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Module s2_ylm_mod </H1>
<PRE>module s2_ylm_mod

        ! Uses
    use <A HREF="s2_types_mod.html">s2_types_mod</A>
    use <A HREF="s2_error_mod.html">s2_error_mod</A>
    use <A HREF="s2_dl_mod.html">s2_dl_mod</A>
    use <A HREF="s2_sky_mod.html">s2_sky_mod</A>

        ! Variables
    integer, public, parameter :: <A HREF="s2_ylm_mod.html#var_s2_ylm_eval_method_leg">S2_YLM_EVAL_METHOD_LEG</A> = 1
    integer, public, parameter :: <A HREF="s2_ylm_mod.html#var_s2_ylm_eval_method_wig">S2_YLM_EVAL_METHOD_WIG</A> = 2
    integer, public, parameter :: <A HREF="s2_ylm_mod.html#var_s2_ylm_reality_real">S2_YLM_REALITY_REAL</A> = 1
    integer, public, parameter :: <A HREF="s2_ylm_mod.html#var_s2_ylm_reality_imag">S2_YLM_REALITY_IMAG</A> = 2
    integer, public, parameter :: <A HREF="s2_ylm_mod.html#var_s2_ylm_reality_abs">S2_YLM_REALITY_ABS</A> = 3

        ! Subroutines and functions
    public function <A HREF="s2_ylm_mod.html#function_s2_ylm_sky">s2_ylm_sky</A> (el, m, nside, reality, pix_scheme_in, method_in) result (ylm)
    private function <A HREF="s2_ylm_mod.html#function_s2_ylm_eval_wig">s2_ylm_eval_wig</A> (el, m, theta, phi) result (ylm)
    private function <A HREF="s2_ylm_mod.html#function_s2_ylm_eval_leg">s2_ylm_eval_leg</A> (el, m, theta, phi) result (ylm)
    private function <A HREF="s2_ylm_mod.html#function_s2_ylm_plm">s2_ylm_plm</A> (el, m, x) result (plm)
    private function <A HREF="s2_ylm_mod.html#function_logfact">logfact</A> (n) result (logfactn)

end module s2_ylm_mod
</PRE>
 Provides functionality to compute spherical harmonic functions.
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 February 2008

<HR><H2> Description of Variables </H2>
<A NAME="var_s2_ylm_eval_method_leg"><H3>S2_YLM_EVAL_METHOD_LEG</H3></A>
<PRE>integer, public, parameter :: S2_YLM_EVAL_METHOD_LEG = 1
</PRE>
 Evalute ylms using associated Legendre functions.
<A NAME="var_s2_ylm_eval_method_wig"><H3>S2_YLM_EVAL_METHOD_WIG</H3></A>
<PRE>integer, public, parameter :: S2_YLM_EVAL_METHOD_WIG = 2
</PRE>
 Evaluate ylms using Wigner functions.
<A NAME="var_s2_ylm_reality_real"><H3>S2_YLM_REALITY_REAL</H3></A>
<PRE>integer, public, parameter :: S2_YLM_REALITY_REAL = 1
</PRE>
 Evaluate real part of ylms.
<A NAME="var_s2_ylm_reality_imag"><H3>S2_YLM_REALITY_IMAG</H3></A>
<PRE>integer, public, parameter :: S2_YLM_REALITY_IMAG = 2
</PRE>
 Evaluate imaginary part of ylms.
<A NAME="var_s2_ylm_reality_abs"><H3>S2_YLM_REALITY_ABS</H3></A>
<PRE>integer, public, parameter :: S2_YLM_REALITY_ABS = 3
</PRE>
 Evaluate absolute value of ylms.

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="function_s2_ylm_sky"><H3>s2_ylm_sky</H3></A>
<PRE>public function s2_ylm_sky (el, m, nside, reality, pix_scheme_in, method_in) result (ylm)
    integer, intent(in) :: el
    integer, intent(in) :: m
    integer, intent(in) :: nside
    integer, intent(in) :: reality
    integer, optional, intent(in) :: pix_scheme_in
    integer, optional, intent(in) :: method_in
    type (s2_sky) :: ylm
    ! Calls: pix2ang_nest, pix2ang_ring, s2_error
end function s2_ylm_sky
</PRE>
 Evaluate spherical harmonic function Ylm over full sky.
<P>
 Variables:
   <UL>
   <LI>  el: Harmonic scale l parameter.
   <LI>  m: Harmonic azimuthal scale m parameter.
   <LI>  nside: Healpix resolution parameter to construct sky at.
   <LI>  reality: Reality type to specify whether to compute the real part,
     imaginary part or absolute value of Ylm (since s2_sky_mod only 
     handles real functions on the sphere).
   <LI>  pix_scheme_in: Pixelisation scheme for map.  
   <LI>  method_in: Method used to compute Ylm (S2_YLM_EVAL_METHOD_LEG for
     assocaite Legendre functions; S2_YLM_EVAL_METHOD_WIG for Wigner dlmn
     functions.
   <LI>  ylm: Spherical harmonic function evaluated on the full sky.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 February 2008
<A NAME="function_s2_ylm_eval_wig"><H3>s2_ylm_eval_wig</H3></A>
<PRE>private function s2_ylm_eval_wig (el, m, theta, phi) result (ylm)
    integer, intent(in) :: el
    integer, intent(in) :: m
    real (kind=s2_dp), intent(in) :: theta
    real (kind=s2_dp), intent(in) :: phi
    complex (kind=s2_dpc) :: ylm
    ! Calls: s2_dl_beta_operator, s2_error
end function s2_ylm_eval_wig
</PRE>
 Evaluate spherical harmonic function Ylm at specified value of theta
 and phi using Wigner dlmn function evaluations.
<P>
 Notes:
   <UL>
   <LI>  This function is considerably slower thatn s2_ylm_eval_leg but is
     included for a consistency check.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  el: Harmonic scale l parameter.
   <LI>  m: Harmonic azimuthal scale m parameter.
   <LI>  theta: Spherical coordiante theta value to evalute Ylm at.
   <LI>  phi: Spherical coordiante phi value to evalute Ylm at.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 February 2008
<A NAME="function_s2_ylm_eval_leg"><H3>s2_ylm_eval_leg</H3></A>
<PRE>private function s2_ylm_eval_leg (el, m, theta, phi) result (ylm)
    integer, intent(in) :: el
    integer, intent(in) :: m
    real (kind=s2_dp), intent(in) :: theta
    real (kind=s2_dp), intent(in) :: phi
    complex (kind=s2_dpc) :: ylm
end function s2_ylm_eval_leg
</PRE>
 Evaluate spherical harmonic function Ylm at specified value of theta
 and phi using associated Legendre function evaluations.
<P>
 Variables:
   <UL>
   <LI>  el: Harmonic scale l parameter.
   <LI>  m: Harmonic azimuthal scale m parameter.
   <LI>  theta: Spherical coordiante theta value to evalute Ylm at.
   <LI>  phi: Spherical coordiante phi value to evalute Ylm at.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 February 2008
<A NAME="function_s2_ylm_plm"><H3>s2_ylm_plm</H3></A>
<PRE>private function s2_ylm_plm (el, m, x) result (plm)
    integer, intent(in) :: el
    integer, intent(in) :: m
    real (kind=s2_dp), intent(in) :: x
    real (kind=s2_dp) :: plm
    ! Calls: s2_error
end function s2_ylm_plm
</PRE>
 Computes the associated Legendre function for x, l and m.
 Adapted from numerical recipes.
<P>
 Notes:
   <UL>
   <LI>  Numerical recipies comment:
     Computes the associated Legendre polynomial P_m^l(x).
<P>
   </UL>
 Variables:
   <UL>
   <LI>  el: Legendre function l parameter.
   <LI>  m: Legendre function m parameter.
   <LI>  x: Point to evaluate specified Legendre funtion at.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 June 2005
<A NAME="function_logfact"><H3>logfact</H3></A>
<PRE>private function logfact (n) result (logfactn)
    integer, intent(in) :: n
    real (kind=s2_dp) :: logfactn
    ! Calls: s2_error
end function logfact
</PRE>
 Computes the natural logarithm of an (integer) factorial.
<P>
 Variables:
  <UL>
  <LI>  n: Integer to compute factorial of [input].
  <LI>  logfactn: Natural logarithm of factorial value computed [output].
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 October 2007
</HTML>
