<HTML>
<HEAD>
   <TITLE> program s2_sky2plplot (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Program s2_sky2plplot </H1>
<PRE>program s2_sky2plplot

        ! Uses
    use <A HREF="s2_types_mod.html">s2_types_mod</A>
    use <A HREF="s2_pl_mod.html">s2_pl_mod</A>
    use <A HREF="s2_sky_mod.html">s2_sky_mod</A>

        ! Calls
    call parse_options
    call s2_pl_free
    call s2_pl_plot
    call s2_sky_compute_alm
    call s2_sky_dilate
    call s2_sky_free

        ! Variables
    character (len=S2_STRING_LEN) :: <A HREF="s2_sky2plplot.html#var_filename_sky">filename_sky</A>
    character (len=S2_STRING_LEN) :: <A HREF="s2_sky2plplot.html#var_filename_out">filename_out</A>
    logical :: <A HREF="s2_sky2plplot.html#var_scale">scale</A> = .true.
    character (len=S2_STRING_LEN) :: <A HREF="s2_sky2plplot.html#var_title">title</A> = ''
    type (s2_sky) :: <A HREF="s2_sky2plplot.html#var_sky">sky</A>
    type (s2_pl) :: <A HREF="s2_sky2plplot.html#var_cl">cl</A>
    integer :: <A HREF="s2_sky2plplot.html#var_lmax">lmax</A> = 0
    integer :: <A HREF="s2_sky2plplot.html#var_mmax">mmax</A> = 0
    logical :: <A HREF="s2_sky2plplot.html#var_new_lmax">new_lmax</A> = .false.
    logical :: <A HREF="s2_sky2plplot.html#var_new_mmax">new_mmax</A> = .false.
    logical :: <A HREF="s2_sky2plplot.html#var_dil1_status">dil1_status</A> = .false.
    logical :: <A HREF="s2_sky2plplot.html#var_dil2_status">dil2_status</A> = .false.
    logical :: <A HREF="s2_sky2plplot.html#var_norm_pres">norm_pres</A> = .false.
    real (kind=s2_sp) :: <A HREF="s2_sky2plplot.html#var_dil1">dil1</A>
    real (kind=s2_sp) :: <A HREF="s2_sky2plplot.html#var_dil2">dil2</A>

        ! Subroutines and functions
    subroutine <A HREF="s2_sky2plplot.html#subroutine_parse_options">parse_options</A> ()

end program s2_sky2plplot
</PRE>
 Read a full fits s2_sky file and compute and plot the cl spectrum (dilate 
 sky also if required, see notes below).
<P>
 Notes:
   <UL>
   <LI>  When constructing optimal filters, template sky is saved for dilation 
     of one, when actual template used may be at different scale.  Thus
     functionality incorporated here to dilate sky before computing and 
     plotting cl spectrum.
<P>
   </UL>
 Usage: 
   <UL>
   <LI>  [-help]: Display usage information.
   <LI>  [-inp filename_sky]: Name of full s2_sky fits file containing sky to
      compute and plot pls of.
   <LI>  [-out filename_out]: Name of output postscript to print.
   <LI>  [-scale scale]: Logical to specify whether to scale y axis values to 
     plot dls rather than cls.
   <LI>  [-title title]: Optional title to print on plot.
   <LI>  [-lmax lmax]: Spherical harmonic lmax if computing alms.
   <LI>  [-mmax mmax]: Spherical harmonic mmax if computing alms.
   <LI>  [-dil1 dil1]: First dilation value if dilating sky before computing 
     alms.
   <LI>  [-dil2 dil2]: Second dilation value if dilating sky before computing 
     alms.
   <LI>  [-npres norm_pres]: Logical to specify whether norm preserving dilation 
     is to be performed, if indeed performing a dilation.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005

<HR><H2> Description of Variables </H2>
<A NAME="var_filename_sky"><H3>filename_sky</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_sky
</PRE>
<A NAME="var_filename_out"><H3>filename_out</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_out
</PRE>
<A NAME="var_scale"><H3>scale</H3></A>
<PRE>logical :: scale = .true.
</PRE>
<A NAME="var_title"><H3>title</H3></A>
<PRE>character (len=S2_STRING_LEN) :: title = ''
</PRE>
<A NAME="var_sky"><H3>sky</H3></A>
<PRE>type (s2_sky) :: sky
</PRE>
<A NAME="var_cl"><H3>cl</H3></A>
<PRE>type (s2_pl) :: cl
</PRE>
<A NAME="var_lmax"><H3>lmax</H3></A>
<PRE>integer :: lmax = 0
</PRE>
<A NAME="var_mmax"><H3>mmax</H3></A>
<PRE>integer :: mmax = 0
</PRE>
<A NAME="var_new_lmax"><H3>new_lmax</H3></A>
<PRE>logical :: new_lmax = .false.
</PRE>
<A NAME="var_new_mmax"><H3>new_mmax</H3></A>
<PRE>logical :: new_mmax = .false.
</PRE>
<A NAME="var_dil1_status"><H3>dil1_status</H3></A>
<PRE>logical :: dil1_status = .false.
</PRE>
<A NAME="var_dil2_status"><H3>dil2_status</H3></A>
<PRE>logical :: dil2_status = .false.
</PRE>
<A NAME="var_norm_pres"><H3>norm_pres</H3></A>
<PRE>logical :: norm_pres = .false.
</PRE>
<A NAME="var_dil1"><H3>dil1</H3></A>
<PRE>real (kind=s2_sp) :: dil1
</PRE>
<A NAME="var_dil2"><H3>dil2</H3></A>
<PRE>real (kind=s2_sp) :: dil2
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_parse_options"><H3>parse_options</H3></A>
<PRE>subroutine parse_options ()
    ! Calls: getArgument
end subroutine parse_options
</PRE>
 Parse the options passed when program called.
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
</HTML>
