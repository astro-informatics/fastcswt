<HTML>
<HEAD>
   <TITLE> module cswt_tr_mod (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Module cswt_tr_mod </H1>
<PRE>module cswt_tr_mod

        ! Uses
    use <A HREF="s2_types_mod.html">s2_types_mod</A>
    use <A HREF="s2_sky_mod.html">s2_sky_mod</A>
    use <A HREF="s2_vect_mod.html">s2_vect_mod</A>
    use <A HREF="cswt_error_mod.html">cswt_error_mod</A>
    use <A HREF="cswt_swav_mod.html">cswt_swav_mod</A>

        ! Types
    public type <A HREF="cswt_tr_mod.html#type_cswt_tr">cswt_tr</A>

        ! Variables
    integer, public, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_dil_unit_rad">CSWT_TR_DIL_UNIT_RAD</A> = 1
    integer, public, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_dil_unit_arcmin">CSWT_TR_DIL_UNIT_ARCMIN</A> = 2
    character (len=*), private, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_dil_unit_str_rad">CSWT_TR_DIL_UNIT_STR_RAD</A> = 'radian'
    character (len=*), private, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_dil_unit_str_arcmin">CSWT_TR_DIL_UNIT_STR_ARCMIN</A> = 'arcmin'
    integer, public, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_method_fast_fft_real">CSWT_TR_METHOD_FAST_FFT_REAL</A> = 1
    integer, public, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_method_fast_fft">CSWT_TR_METHOD_FAST_FFT</A> = 2
    integer, public, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_method_fast_dft">CSWT_TR_METHOD_FAST_DFT</A> = 3
    integer, public, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_method_fast_isotropic">CSWT_TR_METHOD_FAST_ISOTROPIC</A> = 4
    integer, public, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_method_direct">CSWT_TR_METHOD_DIRECT</A> = 5
    integer, public, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_kernel_type_sqr">CSWT_TR_KERNEL_TYPE_SQR</A> = 1
    integer, public, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_kernel_type_circ">CSWT_TR_KERNEL_TYPE_CIRC</A> = 2
    integer, public, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_mask_gen_cswt">CSWT_TR_MASK_GEN_CSWT</A> = 1
    integer, public, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_mask_gen_morph">CSWT_TR_MASK_GEN_MORPH</A> = 2
    integer, public, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_thres_nsigma_mode_abs">CSWT_TR_THRES_NSIGMA_MODE_ABS</A> = 1
    integer, public, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_thres_nsigma_mode_above">CSWT_TR_THRES_NSIGMA_MODE_ABOVE</A> = 2
    integer, public, parameter :: <A HREF="cswt_tr_mod.html#var_cswt_tr_thres_nsigma_mode_below">CSWT_TR_THRES_NSIGMA_MODE_BELOW</A> = 3

        ! Interfaces
    public interface <A HREF="cswt_tr_mod.html#interface_cswt_tr_init">cswt_tr_init</A>
    public interface <A HREF="cswt_tr_mod.html#interface_cswt_tr_const_multiply">cswt_tr_const_multiply</A>
    public interface <A HREF="cswt_tr_mod.html#interface_cswt_tr_const_subtract">cswt_tr_const_subtract</A>
    public interface <A HREF="cswt_tr_mod.html#interface_cswt_tr_wcoeff_sigma">cswt_tr_wcoeff_sigma</A>

        ! Subroutines and functions
    private function <A HREF="cswt_tr_mod.html#function_cswt_tr_init_data">cswt_tr_init_data</A> (swav_mother, dilation, lmax, mmax, n_gamma) result (tr)
    private function <A HREF="cswt_tr_mod.html#function_cswt_tr_init_file_dil">cswt_tr_init_file_dil</A> (swav_mother, filename_dil, lmax, mmax, n_gamma) result (tr)
    private function <A HREF="cswt_tr_mod.html#function_cswt_tr_init_file">cswt_tr_init_file</A> (filename_swav, filename_dil, lmax, mmax, n_gamma, wav_name) result (tr)
    private function <A HREF="cswt_tr_mod.html#function_cswt_tr_init_read">cswt_tr_init_read</A> (filename) result (tr)
    private function <A HREF="cswt_tr_mod.html#function_cswt_tr_init_computed">cswt_tr_init_computed</A> (dilation, wcoeff, lmax, mmax) result (tr)
    private function <A HREF="cswt_tr_mod.html#function_cswt_tr_init_copy">cswt_tr_init_copy</A> (orig) result (copy)
    private function <A HREF="cswt_tr_mod.html#function_cswt_tr_init_merg">cswt_tr_init_merg</A> (tr) result (tr_merg)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_free">cswt_tr_free</A> (tr)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_analysis">cswt_tr_analysis</A> (tr, data, method, message_status, time_it, filename_isotropic)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_anadirect">cswt_tr_anadirect</A> (tr, data, message)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_anafast">cswt_tr_anafast</A> (tr, data, method, message, filename_isotropic)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_anafast_isotropic">cswt_tr_anafast_isotropic</A> (tr, i_dil, sky, swav, message, filename)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_anafast_spcv">cswt_tr_anafast_spcv</A> (tr, i_dil, sky1, sky2, method_in, message)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_anafast_fft3d">cswt_tr_anafast_fft3d</A> (x, backward)
    private function <A HREF="cswt_tr_mod.html#function_cswt_tr_anafast_imdft">cswt_tr_anafast_imdft</A> (tmmm, alpha, beta, gamma) result (t)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_norm">cswt_tr_norm</A> (tr, norm, weight_in)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_multiply">cswt_tr_multiply</A> (tr1, tr2, weight_in)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_const_multiply_array">cswt_tr_const_multiply_array</A> (tr, mfactor)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_const_multiply_val">cswt_tr_const_multiply_val</A> (tr, mfactor)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_const_subtract_array">cswt_tr_const_subtract_array</A> (tr, val)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_const_subtract_val">cswt_tr_const_subtract_val</A> (tr, val)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_wcoeff_sigma_each">cswt_tr_wcoeff_sigma_each</A> (tr, n_effective_samples, mean, sigma)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_wcoeff_sigma_all">cswt_tr_wcoeff_sigma_all</A> (tr, n_effective_samples, mean, sigma)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_wcoeff_thres_nsigma">cswt_tr_wcoeff_thres_nsigma</A> (tr, nsigma, mode, n_effective_samples_in)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_localmax_ab">cswt_tr_localmax_ab</A> (tr, i_dil, n_regions, max_val, max_loc, max_siz, filename_connected)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_connected_ab">cswt_tr_connected_ab</A> (tr, i_dil, i_gamma)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_equivclass">cswt_tr_equivclass</A> (tab, n_equiv_pair, equiv)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_reallocate_mat">cswt_tr_reallocate_mat</A> (mat, x_axis)
    private function <A HREF="cswt_tr_mod.html#function_cswt_tr_present_vect_int">cswt_tr_present_vect_int</A> (vect, val) result (pres)
    private function <A HREF="cswt_tr_mod.html#function_cswt_tr_present_mat_int">cswt_tr_present_mat_int</A> (mat, val) result (pres)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_mask_nonzero">cswt_tr_mask_nonzero</A> (tr_mask, ncoeff_eff, ncoeff_tot)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_mask_nonzero_weight">cswt_tr_mask_nonzero_weight</A> (tr_mask, prop)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_mask_invert">cswt_tr_mask_invert</A> (tr_mask)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_mask_apply">cswt_tr_mask_apply</A> (tr, tr_mask, display_in)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_mask_thres_nsigma">cswt_tr_mask_thres_nsigma</A> (tr, nsigma, n_effective_samples, mode)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_mask_copy">cswt_tr_mask_copy</A> (tr_mask, sky_mask)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_mask_gen">cswt_tr_mask_gen</A> (tr_mask, sky_mask, mode, run_stage1_in, run_stage2_in, orig_mask_only_in, thres1_proportion_in, thres2_proportion_in, thres1_min_in, std_in)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_morph_erode_ab">cswt_tr_morph_erode_ab</A> (tr, i_dil, i_gamma, kernel_size, kernel_type)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_morph_dilate_ab">cswt_tr_morph_dilate_ab</A> (tr, i_dil, i_gamma, kernel_size, kernel_type)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_smooth_gaussian">cswt_tr_smooth_gaussian</A> (tr, kernel_size1, kernel_size2, std)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_smooth_gaussian_ab">cswt_tr_smooth_gaussian_ab</A> (tr, kernel_size1, kernel_size2, std, i_dil, i_gamma)
    public function <A HREF="cswt_tr_mod.html#function_cswt_tr_extract_wcoeff_sky">cswt_tr_extract_wcoeff_sky</A> (tr, i_dil, i_gamma, nside, interp, pix_scheme_in) result (sky)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_io_fits_write_wcoeff_sky">cswt_tr_io_fits_write_wcoeff_sky</A> (filename, tr, i_dil, i_gamma, nside, interp, pix_scheme_in, comment)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_io_fits_write_wcoeff">cswt_tr_io_fits_write_wcoeff</A> (filename, tr, comment)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_io_fits_read_wcoeff">cswt_tr_io_fits_read_wcoeff</A> (filename, tr)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_io_fits_error_check">cswt_tr_io_fits_error_check</A> (status, halt)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_io_fits_exists">cswt_tr_io_fits_exists</A> (filename, status, exists)
    private subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_io_fits_del">cswt_tr_io_fits_del</A> (filename, status)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_io_txt_dilation_write">cswt_tr_io_txt_dilation_write</A> (filename, tr, unit)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_io_txt_dilation_read">cswt_tr_io_txt_dilation_read</A> (filename, dilation)
    public function <A HREF="cswt_tr_mod.html#function_cswt_tr_get_init">cswt_tr_get_init</A> (tr) result (init)
    public function <A HREF="cswt_tr_mod.html#function_cswt_tr_get_swav_mother">cswt_tr_get_swav_mother</A> (tr) result (swav_mother)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_get_wcoeff">cswt_tr_get_wcoeff</A> (tr, wcoeff)
    public subroutine <A HREF="cswt_tr_mod.html#subroutine_cswt_tr_get_dilation">cswt_tr_get_dilation</A> (tr, dilation)
    public function <A HREF="cswt_tr_mod.html#function_cswt_tr_get_lmax">cswt_tr_get_lmax</A> (tr) result (lmax)
    public function <A HREF="cswt_tr_mod.html#function_cswt_tr_get_mmax">cswt_tr_get_mmax</A> (tr) result (mmax)
    public function <A HREF="cswt_tr_mod.html#function_cswt_tr_get_n_alpha">cswt_tr_get_n_alpha</A> (tr) result (n_alpha)
    public function <A HREF="cswt_tr_mod.html#function_cswt_tr_get_n_beta">cswt_tr_get_n_beta</A> (tr) result (n_beta)
    public function <A HREF="cswt_tr_mod.html#function_cswt_tr_get_n_gamma">cswt_tr_get_n_gamma</A> (tr) result (n_gamma)
    public function <A HREF="cswt_tr_mod.html#function_cswt_tr_get_n_dilation">cswt_tr_get_n_dilation</A> (tr) result (n_dilation)
    public function <A HREF="cswt_tr_mod.html#function_cswt_tr_get_wcoeff_status">cswt_tr_get_wcoeff_status</A> (tr) result (wcoeff_status)
    public function <A HREF="cswt_tr_mod.html#function_cswt_tr_get_swav_mother_status">cswt_tr_get_swav_mother_status</A> (tr) result (swav_mother_status)

end module cswt_tr_mod
</PRE>
 Provides functionality to support and compute the directional spherical 
 wavelet transform.  In addition the mother wavelet, the dilation values 
 and all wavelet parameters are stored herein.  The resulting wavelet 
 coefficients for each dilation are sampled on an ecp (equi-sampled) 
 alpha-beta-gamma Euler angle grid.  Functionality is also provided to
 convert the alpha-beta dimensions to Healpix sky representations and
 vice versa.
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004

<HR><H2> Description of Types </H2>
<A NAME="type_cswt_tr"><H3>cswt_tr</H3></A>
<PRE>public type cswt_tr
    private
    logical :: init = .false.
    type (cswt_swav) :: swav_mother
    real (kind=s2_sp), allocatable, dimension (:,:,:,:) :: wcoeff
    real (kind=s2_sp), allocatable, dimension (:,:) :: dilation
    integer :: lmax = 0
    integer :: mmax = 0
    integer :: n_alpha = 0
    integer :: n_beta = 0
    integer :: n_gamma = 0
    integer :: n_dilation = 0
    logical :: wcoeff_status = .false.
    logical :: swav_mother_status = .false.
end type cswt_tr
</PRE>

<HR><H2> Description of Variables </H2>
<A NAME="var_cswt_tr_dil_unit_rad"><H3>CSWT_TR_DIL_UNIT_RAD</H3></A>
<PRE>integer, public, parameter :: CSWT_TR_DIL_UNIT_RAD = 1
</PRE>
 Radian dilation unit specifier.
<A NAME="var_cswt_tr_dil_unit_arcmin"><H3>CSWT_TR_DIL_UNIT_ARCMIN</H3></A>
<PRE>integer, public, parameter :: CSWT_TR_DIL_UNIT_ARCMIN = 2
</PRE>
 Arcminute dilation unit specifier.
<A NAME="var_cswt_tr_dil_unit_str_rad"><H3>CSWT_TR_DIL_UNIT_STR_RAD</H3></A>
<PRE>character (len=*), private, parameter :: CSWT_TR_DIL_UNIT_STR_RAD = 'radian'
</PRE>
<A NAME="var_cswt_tr_dil_unit_str_arcmin"><H3>CSWT_TR_DIL_UNIT_STR_ARCMIN</H3></A>
<PRE>character (len=*), private, parameter :: CSWT_TR_DIL_UNIT_STR_ARCMIN = 'arcmin'
</PRE>
<A NAME="var_cswt_tr_method_fast_fft_real"><H3>CSWT_TR_METHOD_FAST_FFT_REAL</H3></A>
<PRE>integer, public, parameter :: CSWT_TR_METHOD_FAST_FFT_REAL = 1
</PRE>
 Fast FFT analysis method specifier.
<A NAME="var_cswt_tr_method_fast_fft"><H3>CSWT_TR_METHOD_FAST_FFT</H3></A>
<PRE>integer, public, parameter :: CSWT_TR_METHOD_FAST_FFT = 2
</PRE>
 Fast FFT analysis method specifier.
<A NAME="var_cswt_tr_method_fast_dft"><H3>CSWT_TR_METHOD_FAST_DFT</H3></A>
<PRE>integer, public, parameter :: CSWT_TR_METHOD_FAST_DFT = 3
</PRE>
 Fast DFT analysis method specifier.
<A NAME="var_cswt_tr_method_fast_isotropic"><H3>CSWT_TR_METHOD_FAST_ISOTROPIC</H3></A>
<PRE>integer, public, parameter :: CSWT_TR_METHOD_FAST_ISOTROPIC = 4
</PRE>
 Fast isotropic analysis method specifier.
<A NAME="var_cswt_tr_method_direct"><H3>CSWT_TR_METHOD_DIRECT</H3></A>
<PRE>integer, public, parameter :: CSWT_TR_METHOD_DIRECT = 5
</PRE>
 Direct analysis method specifier.
<A NAME="var_cswt_tr_kernel_type_sqr"><H3>CSWT_TR_KERNEL_TYPE_SQR</H3></A>
<PRE>integer, public, parameter :: CSWT_TR_KERNEL_TYPE_SQR = 1
</PRE>
 Square kernel type specifier.
<A NAME="var_cswt_tr_kernel_type_circ"><H3>CSWT_TR_KERNEL_TYPE_CIRC</H3></A>
<PRE>integer, public, parameter :: CSWT_TR_KERNEL_TYPE_CIRC = 2
</PRE>
 Circular kernel type specifier.
<A NAME="var_cswt_tr_mask_gen_cswt"><H3>CSWT_TR_MASK_GEN_CSWT</H3></A>
<PRE>integer, public, parameter :: CSWT_TR_MASK_GEN_CSWT = 1
</PRE>
 Generate mask from wavelet coefficients specifier.
<A NAME="var_cswt_tr_mask_gen_morph"><H3>CSWT_TR_MASK_GEN_MORPH</H3></A>
<PRE>integer, public, parameter :: CSWT_TR_MASK_GEN_MORPH = 2
</PRE>
 Generate mask by morphological operations specifier.
<A NAME="var_cswt_tr_thres_nsigma_mode_abs"><H3>CSWT_TR_THRES_NSIGMA_MODE_ABS</H3></A>
<PRE>integer, public, parameter :: CSWT_TR_THRES_NSIGMA_MODE_ABS = 1
</PRE>
 Generate thresholded nsigma mask by considering absolte value.
<A NAME="var_cswt_tr_thres_nsigma_mode_above"><H3>CSWT_TR_THRES_NSIGMA_MODE_ABOVE</H3></A>
<PRE>integer, public, parameter :: CSWT_TR_THRES_NSIGMA_MODE_ABOVE = 2
</PRE>
 Generate thresholded nsigma mask by leaving values above threshold.
<A NAME="var_cswt_tr_thres_nsigma_mode_below"><H3>CSWT_TR_THRES_NSIGMA_MODE_BELOW</H3></A>
<PRE>integer, public, parameter :: CSWT_TR_THRES_NSIGMA_MODE_BELOW = 3
</PRE>
 Generate thresholded nsigma mask by leaving values below threshold.

<HR><H2> Description of Interfaces </H2>
<A NAME="interface_cswt_tr_init"><H3>cswt_tr_init</H3></A>
<PRE>public interface cswt_tr_init
    module procedure <A HREF="#function_cswt_tr_init_data">cswt_tr_init_data</A>
    module procedure <A HREF="#function_cswt_tr_init_file_dil">cswt_tr_init_file_dil</A>
    module procedure <A HREF="#function_cswt_tr_init_file">cswt_tr_init_file</A>
    module procedure <A HREF="#function_cswt_tr_init_read">cswt_tr_init_read</A>
    module procedure <A HREF="#function_cswt_tr_init_copy">cswt_tr_init_copy</A>
    module procedure <A HREF="#function_cswt_tr_init_merg">cswt_tr_init_merg</A>
end interface cswt_tr_init
</PRE>
<A NAME="interface_cswt_tr_const_multiply"><H3>cswt_tr_const_multiply</H3></A>
<PRE>public interface cswt_tr_const_multiply
    module procedure <A HREF="#subroutine_cswt_tr_const_multiply_array">cswt_tr_const_multiply_array</A>
    module procedure <A HREF="#subroutine_cswt_tr_const_multiply_val">cswt_tr_const_multiply_val</A>
end interface cswt_tr_const_multiply
</PRE>
<A NAME="interface_cswt_tr_const_subtract"><H3>cswt_tr_const_subtract</H3></A>
<PRE>public interface cswt_tr_const_subtract
    module procedure <A HREF="#subroutine_cswt_tr_const_subtract_array">cswt_tr_const_subtract_array</A>
    module procedure <A HREF="#subroutine_cswt_tr_const_subtract_val">cswt_tr_const_subtract_val</A>
end interface cswt_tr_const_subtract
</PRE>
<A NAME="interface_cswt_tr_wcoeff_sigma"><H3>cswt_tr_wcoeff_sigma</H3></A>
<PRE>public interface cswt_tr_wcoeff_sigma
    module procedure <A HREF="#subroutine_cswt_tr_wcoeff_sigma_each">cswt_tr_wcoeff_sigma_each</A>
    module procedure <A HREF="#subroutine_cswt_tr_wcoeff_sigma_all">cswt_tr_wcoeff_sigma_all</A>
end interface cswt_tr_wcoeff_sigma
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="function_cswt_tr_init_data"><H3>cswt_tr_init_data</H3></A>
<PRE>private function cswt_tr_init_data (swav_mother, dilation, lmax, mmax, n_gamma) result (tr)
    type (cswt_swav), intent(in) :: swav_mother
    real (kind=s2_sp), intent(in), dimension (:,:) :: dilation
    integer, intent(in) :: lmax
    integer, intent(in) :: mmax
    integer, intent(in) :: n_gamma
    type (cswt_tr) :: tr
    ! Calls: cswt_error
end function cswt_tr_init_data
</PRE>
 Initialise a tr structure from a mother wavelet, dilations and 
 resolution parameters.
<P>
 Notes:
   <UL>
   <LI>  Space for wcoeff is allocated when tr is initialised (before 
     actually calculate coefficients).
   <LI>  Note that the wcoeff data array is indexed from <STRONG>one</STRONG> for the
     dilation dimensions, but from <STRONG>zero</STRONG> for the Euler angle
     dimensions.
   <LI>  n_gamma must be odd for the fast cswt.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  swav_mother: Mother wavelet.
   <LI>  dilation: Dilation values.
   <LI>  lmax: Alm lmax.
   <LI>  mmax: Alm mmax.
   <LI>  n_gamma: Number of gamma Euler orientation to consider in the 
     directional transform.  
   <LI>  tr: Returned tr structure initialised with a mother wavelet, 
     dilations and resolution parameters.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_init_file_dil"><H3>cswt_tr_init_file_dil</H3></A>
<PRE>private function cswt_tr_init_file_dil (swav_mother, filename_dil, lmax, mmax, n_gamma) result (tr)
    type (cswt_swav), intent(in) :: swav_mother
    character (len=*), intent(in) :: filename_dil
    integer, intent(in) :: lmax
    integer, intent(in) :: mmax
    integer, intent(in) :: n_gamma
    type (cswt_tr) :: tr
    ! Calls: cswt_error, cswt_tr_io_txt_dilation_read
end function cswt_tr_init_file_dil
</PRE>
 Initialise a tr strucutre from a mother wavelet, dilations read from
 an input dilation text file and resolution parameters.
<P>
 Notes:
   <UL>
   <LI>  Once dilations are read cswt_tr_init_data is called.
   <LI>  Space for wcoeff is allocated when tr is initialised (before 
     actually calculate coefficients).
   <LI>  Note that the wcoeff data array is indexed from <STRONG>one</STRONG> for the
     dilation dimensions, but from <STRONG>zero</STRONG> for the Euler angle
     dimensions.
   <LI>  n_gamma must be odd for the fast cswt.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  swav_mother: Mother wavelet.
   <LI>  filename_dil: Name of input dilation file.
   <LI>  lmax: Alm lmax.
   <LI>  mmax: Alm mmax.
   <LI>  n_gamma: Number of gamma Euler orientation to consider in the 
     directional transform.  
   <LI>  tr: Returned tr structure initialised with a mother wavelet, 
     dilations and resolution parameters.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_init_file"><H3>cswt_tr_init_file</H3></A>
<PRE>private function cswt_tr_init_file (filename_swav, filename_dil, lmax, mmax, n_gamma, wav_name) result (tr)
    character (len=*), intent(in) :: filename_swav
    character (len=*), intent(in) :: filename_dil
    integer, intent(in) :: lmax
    integer, intent(in) :: mmax
    integer, intent(in) :: n_gamma
    character (len=*), optional, intent(in) :: wav_name
    type (cswt_tr) :: tr
    ! Calls: cswt_error, cswt_swav_free
end function cswt_tr_init_file
</PRE>
 Initialise a tr strucutre from a mother wavelet read from an input 
 fits file, dilations read from an input dilation text file and 
 resolution parameters.
<P>
 Notes:
   <UL>
   <LI>  Once the wavelet is read cswt_tr_init_dil is called.
   <LI>  Space for wcoeff is allocated when tr is initialised (before 
     actually calculate coefficients).
   <LI>  Note that the wcoeff data array is indexed from <STRONG>one</STRONG> for the
     dilation dimensions, but from <STRONG>zero</STRONG> for the Euler angle
     dimensions.
   <LI>  n_gamma must be odd for the fast cswt.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename_swav: Name of input fits sky file containing the mother
     wavelet.
   <LI>  filename_dil: Name of input dilation file.
   <LI>  lmax: Alm lmax.
   <LI>  mmax: Alm mmax.
   <LI>  n_gamma: Number of gamma Euler orientation to consider in the 
     directional transform.  
   <LI>  [wav_name]: Name of mother wavelet type.
   <LI>  tr: Returned tr structure initialised with a mother wavelet, 
     dilations and resolution parameters.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_init_read"><H3>cswt_tr_init_read</H3></A>
<PRE>private function cswt_tr_init_read (filename) result (tr)
    character (len=*), intent(in) :: filename
    type (cswt_tr) :: tr
    ! Calls: cswt_error, cswt_tr_io_fits_read_wcoeff
end function cswt_tr_init_read
</PRE>
 Wrapper to initalise a tr data structure from a file.  The tr 
 structure is read and initialised by the routine 
 cswt_tr_io_fits_read_wcoeff.
<P>
 Notes: 
   <UL>
   <LI>  If a tr structure is initialised in this manner then no wavelet
     is stored and further analysis calls may not be made.
   <LI>  Note that the wcoeff data array is indexed from <STRONG>one</STRONG> for the
     dilation dimensions, but from <STRONG>zero</STRONG> for the Euler angle
     dimensions.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of wavelet coefficient fits file containing the tr 
     data to be read.
   <LI>  tr: Returned tr structure initialised with the data contained in
     the input fits file.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_init_computed"><H3>cswt_tr_init_computed</H3></A>
<PRE>private function cswt_tr_init_computed (dilation, wcoeff, lmax, mmax) result (tr)
    real (kind=s2_sp), intent(in), dimension (:,:) :: dilation
    real (kind=s2_sp), intent(in), dimension (:,:,:,:) :: wcoeff
    integer, intent(in) :: lmax
    integer, intent(in) :: mmax
    type (cswt_tr) :: tr
    ! Calls: cswt_error
end function cswt_tr_init_computed
</PRE>
 Initialise a tr structure from precomputed wavelet coefficients
 (if, say, read from file).
<P>
 Notes:
   <UL>
   <LI>  If a tr structure is initialised in this manner then no wavelet
     is stored and further analysis calls may not be made.
   <LI>  Note that the wcoeff data array is indexed from <STRONG>one</STRONG> for the
     dilation dimensions, but from <STRONG>zero</STRONG> for the Euler angle
     dimensions.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  dilation: Array of dilation values.
   <LI>  wcoeff: Array of wavelet coefficients.
   <LI>  lmax: Alm lmax.
   <LI>  mmax: Alm mmax.
   <LI>  tr: Returned tr strucutre initialised with the wavelet coefficients
     and dilations passed as input.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_init_copy"><H3>cswt_tr_init_copy</H3></A>
<PRE>private function cswt_tr_init_copy (orig) result (copy)
    type (cswt_tr), intent(in) :: orig
    type (cswt_tr) :: copy
    ! Calls: cswt_error
end function cswt_tr_init_copy
</PRE>
 Initialise a tr structure as a copy of another tr.
<P>
 Variables:
   <UL>
   <LI>  orig: Original tr to be copied.
   <LI>  copy: Returned tr strucutre initialised with a copy of the original.
<P>
   </UL>
 Notes:
   <UL>
   <LI>  Note that the wcoeff data array is indexed from <STRONG>one</STRONG> for the
     dilation dimensions, but from <STRONG>zero</STRONG> for the Euler angle
     dimensions.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_init_merg"><H3>cswt_tr_init_merg</H3></A>
<PRE>private function cswt_tr_init_merg (tr) result (tr_merg)
    type (cswt_tr), intent(in), dimension (:) :: tr
    type (cswt_tr) :: tr_merg
    ! Calls: cswt_error
end function cswt_tr_init_merg
</PRE>
 Initialise a tr structure by merging a number of tr structures that 
 have only a single dilation.
<P>
 Variables:
   <UL>
   <LI>  tr: Array of tr objects to be merged.
   <LI>  tr_merg: Returned merged tr strucutre initialised from the 
     merged tr data.
<P>
   </UL>
 Notes:
   <UL>
   <LI>  Note that the wcoeff data array is indexed from <STRONG>one</STRONG> for the
     dilation dimensions, but from <STRONG>zero</STRONG> for the Euler angle
     dimensions.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005
<A NAME="subroutine_cswt_tr_free"><H3>cswt_tr_free</H3></A>
<PRE>public subroutine cswt_tr_free (tr)
    type (cswt_tr), intent(inout) :: tr
    ! Calls: cswt_error, cswt_swav_free
end subroutine cswt_tr_free
</PRE>
 Free all data associated with an initialised tr structure and reset 
 all other attributes.
<P>
 Variables:
   <UL>
   <LI>  tr: The tr structure to be freed.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_analysis"><H3>cswt_tr_analysis</H3></A>
<PRE>public subroutine cswt_tr_analysis (tr, data, method, message_status, time_it, filename_isotropic)
    type (cswt_tr), intent(inout) :: tr
    type (s2_sky), intent(inout) :: data
    integer, optional, intent(in) :: method
    logical, optional, intent(in) :: message_status
    logical, optional, intent(in) :: time_it
    character (len=*), optional, intent(in) :: filename_isotropic
    ! Calls: cswt_error, cswt_tr_anadirect, cswt_tr_anafast, s2_sky_free, system_clock
end subroutine cswt_tr_analysis
</PRE>
 Perform directional continuous spherical wavelet transform to compute 
 wavelet coefficients.  The actual method employed to compute wavelet 
 coefficients depends on the method specifier.
<P>
 Notes:
   <UL>
   <LI>  Data must have intent inout so can write alms to it.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet structure to compute coefficients of.  The 
     computed coefficients are written to the tr%wcoeff array.
   <LI>  data: The data sky to take the wavelet transform of.
   <LI>  [method]: Optional method specifier to specify the method used to 
     compute the spherical wavelet coefficients.
   <LI>  [message_status]: Logical to indicate whether messages are to be 
     displyed during the analysis routine.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_anadirect"><H3>cswt_tr_anadirect</H3></A>
<PRE>private subroutine cswt_tr_anadirect (tr, data, message)
    type (cswt_tr), intent(inout) :: tr
    type (s2_sky), intent(inout) :: data
    logical, optional, intent(in) :: message
    ! Calls: cswt_error, cswt_swav_dilate, cswt_swav_free, s2_sky_free, s2_sky_get_map, s2_sky_rotate
end subroutine cswt_tr_anadirect
</PRE>
 Perform the direct directional spherical wavelet transform.
<P>
 Variables:   
   <UL>
   <LI>  tr: Spherical wavelet structure to compute coefficients of.  The 
     computed coefficients are written to the tr%wcoeff array.
   <LI>  data: The data sky to take the wavelet transform of.
   <LI>  [message_status]: Logical to indicate whether messages are to be 
     displyed during the analysis routine.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_anafast"><H3>cswt_tr_anafast</H3></A>
<PRE>private subroutine cswt_tr_anafast (tr, data, method, message, filename_isotropic)
    type (cswt_tr), intent(inout) :: tr
    type (s2_sky), intent(inout) :: data
    integer, optional, intent(in) :: method
    logical, optional, intent(in) :: message
    character (len=*), optional, intent(in) :: filename_isotropic
    ! Calls: cswt_error, cswt_swav_compute_alm, cswt_swav_dilate, cswt_swav_free, cswt_tr_anafast_isotropic, cswt_tr_anafast_spcv, s2_sky_compute_alm, s2_sky_free
end subroutine cswt_tr_anafast
</PRE>
 Perform the fast directional spherical wavelet transform.
<P>
 Notes:
   <UL>
   <LI>  For case where alms are already defined (and map isn't) then set 
     dilation to unitary; no dilation will actually be performed and
     analysis can continue.
<P>
   </UL>
 Variables:   
   <UL>
   <LI>  tr: Spherical wavelet structure to compute coefficients of.  The 
     computed coefficients are written to the tr%wcoeff array.
   <LI>  data: The data sky to take the wavelet transform of.
   <LI>  [method]: Optional method specifier to specify the method used to 
     compute the spherical wavelet coefficients.
   <LI>  [message_status]: Logical to indicate whether messages are to be 
     displyed during the analysis routine.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_anafast_isotropic"><H3>cswt_tr_anafast_isotropic</H3></A>
<PRE>private subroutine cswt_tr_anafast_isotropic (tr, i_dil, sky, swav, message, filename)
    type (cswt_tr), intent(inout) :: tr
    integer, intent(in) :: i_dil
    type (s2_sky), intent(in) :: sky
    type (s2_sky), intent(in) :: swav
    logical, optional, intent(in) :: message
    character (len=*), optional, intent(in) :: filename
    ! Calls: cswt_error, s2_sky_compute_map, s2_sky_extract_ab, s2_sky_free, s2_sky_get_alm, s2_sky_write_map_file
end subroutine cswt_tr_anafast_isotropic
</PRE>
 Perform the fast isotropic spherical convolution for a particular 
 dilation (noting the the convolution is simply given by a product of 
 spherical harmonic coefficients).
<P>
 Notes:
   <UL>
   <LI>  Sizes are checked before here so no checking of size consistency is 
     performed herein.  (All skies must have same lmax and mmax as values
     passed to function.)
   <LI>  tr%wcoeff array must be already allocated and must be indexed 
     from 0:N-1 for Euler angle dimensions.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet structure to compute coefficients of.  The 
     computed coefficients are written to the tr%wcoeff array.
   <LI>  i_dil: Dilation index to store computed coefficient in.
   <LI>  sky: Data to convolve.
   <LI>  swav: Dilated wavelet to convolve.
   <LI>  [message_status]: Logical to indicate whether messages are to be 
     displyed during the analysis routine.
   <LI>  [filename]: Name of fits file to save healpix pixelisation of 
     wavelet coefficients in (if present, else not saved)
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_anafast_spcv"><H3>cswt_tr_anafast_spcv</H3></A>
<PRE>private subroutine cswt_tr_anafast_spcv (tr, i_dil, sky1, sky2, method_in, message)
    type (cswt_tr), intent(inout) :: tr
    integer, intent(in) :: i_dil
    type (s2_sky), intent(in) :: sky1
    type (s2_sky), intent(in) :: sky2
    integer, optional, intent(in) :: method_in
    logical, optional, intent(in) :: message
    ! Calls: cswt_error, cswt_tr_anafast_fft3d, rfftw3d_f77_create_plan, rfftwnd_f77_destroy_plan, rfftwnd_f77_one_complex_to_real, s2_dl_beta_operator, s2_sky_get_alm
end subroutine cswt_tr_anafast_spcv
</PRE>
 Perform the fast spherical convolution for a particular dilation 
 using the fast algorithm of Wandlet and Gorski.
<P>
 Notes:
   <UL>
   <LI>  Sizes are checked before here so no checking of size consistency is 
     performed herein.  (All skies must have same lmax and mmax as values
     passed to function.)
   <LI>  tr%wcoeff array must be already allocated and must be indexed 
     from 0:N-1 for Euler angle dimensions.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet structure to compute coefficients of.  The 
     computed coefficients are written to the tr%wcoeff array.
   <LI>  i_dil: Dilation index to store computed coefficient in.
   <LI>  sky1: Data to convolve.
   <LI>  sky2: Dilated wavelet to convolve.
   <LI>  [method_in]: Optional method specifier to specify the method used 
     to compute the spherical wavelet coefficients.
   <LI>  [message_status]: Logical to indicate whether messages are to be 
     displyed during the analysis routine.
   </UL>
<P>
<STRONG>Author:</STRONG> D. J. Mortlock and J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_anafast_fft3d"><H3>cswt_tr_anafast_fft3d</H3></A>
<PRE>private subroutine cswt_tr_anafast_fft3d (x, backward)
    complex (kind=s2_dpc), intent(inout), dimension (:,:,:) :: x
    logical, intent(in) :: backward
    ! Calls: complex_fft
end subroutine cswt_tr_anafast_fft3d
</PRE>
 Perform 3D FFT using healpix fft routines (fftw if linked).
<P>
 Notes:
   <UL>
   <LI>  Since the Fourier transform is separable the 3D transform is
     calculated by taking suitable 1D transforms over each dimension
     of the data.
   <LI>  No scaling performed - even on reverse transform.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  x: The 3D input data on input.  The 3D FFT of the inputted data
     on exit.
   <LI>  backward: Logical specifying whether the forward FFT (.false.) or
     reverse inverse FFT (.true.) is performed.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_anafast_imdft"><H3>cswt_tr_anafast_imdft</H3></A>
<PRE>private function cswt_tr_anafast_imdft (tmmm, alpha, beta, gamma) result (t)
    complex (kind=s2_dpc), intent(in), dimension (:, :, :) :: tmmm
    real (kind=s2_dp), intent(in) :: alpha
    real (kind=s2_dp), intent(in) :: beta
    real (kind=s2_dp), intent(in) :: gamma
    real (kind=s2_sp) :: t
end function cswt_tr_anafast_imdft
</PRE>
 Perform the modified inverse Fourier transform required to convert
 T_mmm to T_abg directly.
<P>
 Notes:
   <UL>
   <LI>  t may be computed for any continuous values of alpha, beta and
     gamma.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tmmm: Input data
     representing the modified 3d Fourier transform of required
     t_abg.  (Now allocated array rather than pointer so indexed from
     1 when accessed herein.)
   <LI>  alpha: Alpha Euler angle to calculate t for.
   <LI>  beta: Beta Euler angle to calculate t for.
   <LI>  gamma: Gamma Euler angle to calculate t for.
   <LI>  t: The modified inverse Fourier transform of tmmm for the
     specified angles.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_norm"><H3>cswt_tr_norm</H3></A>
<PRE>public subroutine cswt_tr_norm (tr, norm, weight_in)
    type (cswt_tr), intent(in) :: tr
    real (kind=s2_sp), intent(out), dimension (:) :: norm
    logical, optional, intent(in) :: weight_in
    ! Calls: cswt_error, cswt_tr_free
end subroutine cswt_tr_norm
</PRE>
 Compute the norm of the wavelet coefficients stored in the tr strucutre 
 for each dilation.  The norm is defined as the sum, over all Euler
 angles, of the squared coefficient values, i.e. 
 norm(a) = 1/N_s * \sum_i ( k_i (W_i)^2 )
 where W_i are the wavelet coefficients, k_i the weights (if
 applied) and N_s is the number of samples per dilation, 
 i.e. N_s = N_alpha * N_beta * N_gamma.  The weights may be optionally
 applied.  <STRONG>Note that N_s=1 now</STRONG>
<P>
 Notes:
   <UL>
   <LI>  Take note that the norm computed is scaled by one over the number
     of samples per dilation.  -- <STRONG>Not any longer</STRONG>: must do scaling 
     separately, since in some cases want to scale by number of
     <STRONG>effective</STRONG> coefficients, not total number.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: The tr structure containing the wavelet coefficients to
     compute the dilation of.
   <LI>  norm: Computed norm values for each dilation.
   <LI>  [weight_in]: Logical to specified whether pixel weights are to be 
     applied.  If not specified then WEIGHT_DEFAULT is assumed.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - December 2004
<A NAME="subroutine_cswt_tr_multiply"><H3>cswt_tr_multiply</H3></A>
<PRE>public subroutine cswt_tr_multiply (tr1, tr2, weight_in)
    type (cswt_tr), intent(inout) :: tr1
    type (cswt_tr), intent(in) :: tr2
    logical, optional, intent(in) :: weight_in
    ! Calls: cswt_error
end subroutine cswt_tr_multiply
</PRE>
 Multiply two wavelet coefficients contained in tr structure arrays. 
 Weight the multiplication for each pixel by the size of the pixel on 
 the sky if desired.  The product coefficients are written to the 
 tr1 structure wavelet coefficient array on exit.
<P>
 Variables:
   <UL>
   <LI>  tr1: First tr structure containing the coefficients to multiply.
     Contains product of coefficients on exit.
   <LI>  tr2: Second tr structure containing the coefficients to multiply.
     Unchanged on exit.
   <LI>  [weight_in]: Logical to specified whether pixel weights are to be 
     applied.  If not specified then WEIGHT_DEFAULT is assumed.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - December 2004
<A NAME="subroutine_cswt_tr_const_multiply_array"><H3>cswt_tr_const_multiply_array</H3></A>
<PRE>private subroutine cswt_tr_const_multiply_array (tr, mfactor)
    type (cswt_tr), intent(inout) :: tr
    real (kind=s2_sp), intent(in), dimension (:) :: mfactor
    ! Calls: cswt_error
end subroutine cswt_tr_const_multiply_array
</PRE>
 Multiply the wavelet coefficients of the tr structure for a given
 dilation by the value of mfactor for the corresponding dilation.
<P>
 Variables:
   <UL>
   <LI>  tr: tr structure containing the coefficients to multiply.
   <LI>  mfactor: Array containing multiplication factor for each dilation.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - December 2004
<A NAME="subroutine_cswt_tr_const_multiply_val"><H3>cswt_tr_const_multiply_val</H3></A>
<PRE>private subroutine cswt_tr_const_multiply_val (tr, mfactor)
    type (cswt_tr), intent(inout) :: tr
    real (kind=s2_sp), intent(in) :: mfactor
    ! Calls: cswt_error
end subroutine cswt_tr_const_multiply_val
</PRE>
 Multiply the wavelet coefficients of the tr structure by a constant 
 value (for all dilations).
<P>
 Variables:
   <UL>
   <LI>  tr: tr structure containing the coefficients to multiply.
   <LI>  mfactor: Constant value to multiply all coefficients by (for all
     dilations).
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - December 2004
<A NAME="subroutine_cswt_tr_const_subtract_array"><H3>cswt_tr_const_subtract_array</H3></A>
<PRE>private subroutine cswt_tr_const_subtract_array (tr, val)
    type (cswt_tr), intent(inout) :: tr
    real (kind=s2_sp), intent(in), dimension (:) :: val
    ! Calls: cswt_error
end subroutine cswt_tr_const_subtract_array
</PRE>
 Subtract the wavelet coefficients of the tr structure for a given
 dilation by the value of val for the corresponding dilation.
<P>
 Variables:
   <UL>
   <LI>  tr: tr structure containing the coefficients to subtract.
   <LI>  val: Array containing subtraction values for each dilation.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - December 2004
<A NAME="subroutine_cswt_tr_const_subtract_val"><H3>cswt_tr_const_subtract_val</H3></A>
<PRE>private subroutine cswt_tr_const_subtract_val (tr, val)
    type (cswt_tr), intent(inout) :: tr
    real (kind=s2_sp), intent(in) :: val
    ! Calls: cswt_error
end subroutine cswt_tr_const_subtract_val
</PRE>
 Subtract the wavelet coefficients of the tr structure by a constant 
 value (for all dilations).
<P>
 Variables:
   <UL>
   <LI>  tr: tr structure containing the coefficients to subtract.
   <LI>  val: Constant value to subtract from all coefficients (for all
     dilations).
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - December 2004
<A NAME="subroutine_cswt_tr_wcoeff_sigma_each"><H3>cswt_tr_wcoeff_sigma_each</H3></A>
<PRE>private subroutine cswt_tr_wcoeff_sigma_each (tr, n_effective_samples, mean, sigma)
    type (cswt_tr), intent(in) :: tr
    integer, intent(in), dimension (:) :: n_effective_samples
    real (kind=s2_sp), intent(out), dimension (:) :: mean
    real (kind=s2_sp), intent(out), dimension (:) :: sigma
    ! Calls: cswt_error
end subroutine cswt_tr_wcoeff_sigma_each
</PRE>
 Compute the mean and standard deviation of the wavelet coefficients of
 the tr strucutre <STRONG>for each dilation</STRONG>.
<P>
 Notes:
   <UL>
   <LI>  If tr wavelet coefficients masked, sigma and mean should be
     computed only over the remaining pixels.  If these pixels are zero,
     then they won't compute to the calculation of mean and sigma, 
     however the number of samples to divide by should be the effective
     number of pixels.  Thus divide by this value, for each dilation, 
     that is passed as an input.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: tr structure containing the coefficients to calculate the mean
     and standard deviation of.
   <LI>  n_effective_samples: Number of effective samples per dilation
     for previously applied mask, if not masked just give full number
     of Euler angle samples (for each dilation - which of course will
     be an array of the same number (n_alpha*n_beta*n_gamma)).
   <LI>  mean: Computed mean array for each dilation.
   <LI>  sigma: Computed standard deviation array for each dilation.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - December 2004
<A NAME="subroutine_cswt_tr_wcoeff_sigma_all"><H3>cswt_tr_wcoeff_sigma_all</H3></A>
<PRE>private subroutine cswt_tr_wcoeff_sigma_all (tr, n_effective_samples, mean, sigma)
    type (cswt_tr), intent(in) :: tr
    integer, intent(in) :: n_effective_samples
    real (kind=s2_sp), intent(out) :: mean
    real (kind=s2_sp), intent(out) :: sigma
    ! Calls: cswt_error
end subroutine cswt_tr_wcoeff_sigma_all
</PRE>
 Compute the mean and standard deviation of the wavelet coefficients of
 the tr strucutre <STRONG>over all dilations</STRONG>.
<P>
 Notes:
   <UL>
   <LI>  If tr wavelet coefficients masked, sigma and mean should be
     computed only over the remaining pixels.  If these pixels are zero,
     then they won't compute to the calculation of mean and sigma, 
     however the number of samples to divide by should be the effective
     number of pixels.  Thus divide by this value that is passed as an 
     input.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: tr structure containing the coefficients to calculate the mean
     and standard deviation of.
   <LI>  n_effective_samples: Number of effective samples, if not masked 
     just give full number of samples: size(tr%wcoeff).
   <LI>  mean: Computed mean over all dilations.
   <LI>  sigma: Computed standard deviation over all dilations.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005
<A NAME="subroutine_cswt_tr_wcoeff_thres_nsigma"><H3>cswt_tr_wcoeff_thres_nsigma</H3></A>
<PRE>public subroutine cswt_tr_wcoeff_thres_nsigma (tr, nsigma, mode, n_effective_samples_in)
    type (cswt_tr), intent(inout) :: tr
    real (kind=s2_sp) :: nsigma
    integer, intent(in) :: mode
    integer, optional, intent(in) :: n_effective_samples_in
    ! Calls: cswt_error, cswt_tr_wcoeff_sigma_all
end subroutine cswt_tr_wcoeff_thres_nsigma
</PRE>
 Threshold wavelet coefficients.  Coefficients that remain keep their 
 original value and are <STRONG>not</STRONG> set to 1.0.  Differs to 
 cswt_tr_mask_thres_nsigma routine since the same nsigma is used over
 all dilations.
<P>
 Notes:
   <UL>
   <LI>  If tr wavelet coefficients masked, sigma and mean should be
     computed only over the remaining pixels.  If these pixels are zero,
     then they won't compute to the calculation of mean and sigma, 
     however the number of samples to divide by should be the effective
     number of pixels.  Thus divide by this value that is passed as 
     an input.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: tr structure containing the coefficients to be thresholded.
     On exit, tr structure containing thresholded coefficients.
   <LI>  n_effective_samples: Number of effective samples, if not masked 
     just give full number of samples: size(tr%wcoeff).
   <LI>  mode: Mode of thresholding to perform.  
     If mode=CSWT_TR_THRES_NSIGMA_MODE_ABS then the absolute value of
     coefficients are considered and those coefficients below (in
     absolute value)  nsigma * sigma are set to zero.
     If mode=CSWT_TR_THRES_NSIGMA_MODE_ABOVE then those coefficients 
     below nsigma * sigma are set to zero.
     If mode=CSWT_TR_THRES_NSIGMA_MODE_BELOW then those coefficients 
     above -nsigma * sigma (<STRONG>note minus sign</STRONG>) are set to zero.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005
<A NAME="subroutine_cswt_tr_localmax_ab"><H3>cswt_tr_localmax_ab</H3></A>
<PRE>public subroutine cswt_tr_localmax_ab (tr, i_dil, n_regions, max_val, max_loc, max_siz, filename_connected)
    type (cswt_tr), intent(in) :: tr
    integer, intent(in) :: i_dil
    integer, allocatable, intent(out), dimension (:) :: n_regions
    real (kind=s2_sp), allocatable, intent(out), dimension (:,:) :: max_val
    integer, allocatable, intent(out), dimension (:,:,:) :: max_loc
    integer, allocatable, intent(out), dimension (:,:) :: max_siz
    character (len=*), optional, intent(in) :: filename_connected
    ! Calls: cswt_error, cswt_tr_connected_ab, cswt_tr_free, cswt_tr_io_fits_write_wcoeff
end subroutine cswt_tr_localmax_ab
</PRE>
 Find local maxima in a single ab slice of the wavelet coefficients
 (performed for each orientation separately).
 The input coefficients should already be thresholded so that only local
 non-zero regions remain for which the maximum of each is found.
<P>
 Notes:
   <UL>
   <LI>  Note the tr structure passed should be thresholded so only need 
     to find local maximum in each connected component region.
   <LI>  Data arrays of maximum local values and locations are allocated
     herein, since no prior knowledge of number of objects contained 
     in map.  These arrays <STRONG>must</STRONG> be freed by the calling routine.
   <LI>  Both the dilation (i_dil) and <STRONG>orientation</STRONG> (i_gamma) are
     indexed from 1:N.
   <LI>  The algorithm works by finding the connected components in 
     thresholded wavelet coefficient map.  The maximum of each 
     connected component is taken as the local maximum.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: <STRONG>Thresholded</STRONG> tr structure containing non-zero local regions
     to find maxima of.
   <LI>  i_dil: Dilation index of tr%wcoeff map to consider.
   <LI>  i_gamma: Gamma Euler angle index of tr%wcoeff to consider 
     (indexed from 1:N).
   <LI>  max_val: List of local maximum values found.
   <LI>  max_loc: List of locations of local maximum values found.
   <LI>  [filename_connected]: If present save cswt file of connected 
     components.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005
<A NAME="subroutine_cswt_tr_connected_ab"><H3>cswt_tr_connected_ab</H3></A>
<PRE>private subroutine cswt_tr_connected_ab (tr, i_dil, i_gamma)
    type (cswt_tr), intent(inout) :: tr
    integer, intent(in) :: i_dil
    integer, intent(in) :: i_gamma
    ! Calls: cswt_error, cswt_tr_equivclass, cswt_tr_reallocate_mat
end subroutine cswt_tr_connected_ab
</PRE>
 Find wavelet coefficient connected components (defined by non-zero 
 pixels) and overwrite with integer label for each connected component.
<P>
 Notes:
   <UL>
   <LI>  Both the dilation (i_dil) and <STRONG>orientation</STRONG> (i_gamma) are
     indexed from 1:N.
   <LI>  Connected components defined by non-zero pixels (non-zero values
     are irrelevant).
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: <STRONG>Thresholded</STRONG> tr structure to find connected components of.
     On exit, coefficients contain integer values (although real 
      precision) labelling connected components.
   <LI>  i_dil: Dilation index of tr%wcoeff map to consider.
   <LI>  i_gamma: Gamma Euler angle index of tr%wcoeff to consider 
     (indexed from 1:N).
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005
<A NAME="subroutine_cswt_tr_equivclass"><H3>cswt_tr_equivclass</H3></A>
<PRE>private subroutine cswt_tr_equivclass (tab, n_equiv_pair, equiv)
    integer, intent(in), dimension (:,:) :: tab
    integer, intent(in) :: n_equiv_pair
    integer, allocatable, intent(out), dimension (:,:) :: equiv
    ! Calls: cswt_error, cswt_tr_reallocate_mat
end subroutine cswt_tr_equivclass
</PRE>
 Resolve a table of equivalence pairs into a table of equivalence 
 classes.
<P>
 Notes:
   <UL>
   <LI>  Note memory for equic is allocated here and <STRONG>must</STRONG> be freed be 
     calling routine.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tab: Original table of equivalence pairs.  Table may be larger 
     than actual number of pairs - unused cells filled with zeros.
   <LI>  n_equiv_pair: Number of equivalence pairs in tab (number of 
     non-zero rows of table).
   <LI>  equiv: Table of equivalence classes.  Table may be larger than 
     required - unused cells filled with zeros.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005
<A NAME="subroutine_cswt_tr_reallocate_mat"><H3>cswt_tr_reallocate_mat</H3></A>
<PRE>private subroutine cswt_tr_reallocate_mat (mat, x_axis)
    integer, allocatable, dimension (:,:) :: mat
    logical, intent(in) :: x_axis
    ! Calls: cswt_error
end subroutine cswt_tr_reallocate_mat
</PRE>
 Dynamically reallocate a 2D array to increase its size, either in the x 
 or y direction.
<P>
 Notes:
   <UL>
   <LI>  Original mat must be allocatable.
   <LI>  Current implementation is only for integer mat.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  mat: Original matrix to increase the size of.  On exit, mat 
     contains the same data but has a larger size.
   <LI>  x_axis: Logical indication whether to increase the size of mat in
     the x (down) direction.  If false then size is increased in the y
     (across) direction.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005
<A NAME="function_cswt_tr_present_vect_int"><H3>cswt_tr_present_vect_int</H3></A>
<PRE>private function cswt_tr_present_vect_int (vect, val) result (pres)
    integer, intent(in), dimension (:) :: vect
    integer, intent(in) :: val
    logical :: pres
end function cswt_tr_present_vect_int
</PRE>
 Check if a value is present in a vector.
<P>
 Notes:
   <UL>
   <LI>  Could simply subtract value from vect, then take product of all
     elements.  Result will be zero if value is present.  Errors with 
     this approach however (error with product intrinsic function?), so
     search directly.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  vect: Vector to search for value in.
   <LI>  val: Test value to look for in vector.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005
<A NAME="function_cswt_tr_present_mat_int"><H3>cswt_tr_present_mat_int</H3></A>
<PRE>private function cswt_tr_present_mat_int (mat, val) result (pres)
    integer, intent(in), dimension (:,:) :: mat
    integer, intent(in) :: val
    logical :: pres
end function cswt_tr_present_mat_int
</PRE>
 Check if a value is present in a 2D matrix.
<P>
 Notes:
   <UL>
   <LI>  Could simply subtract value from mat, then take product of all
     elements.  Result will be zero if value is present.  Errors with 
     this approach however (error with product intrinsic function?), so
     search directly.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  mat: matrix to search for value in.
   <LI>  val: Test value to look for in vector.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005
<A NAME="subroutine_cswt_tr_mask_nonzero"><H3>cswt_tr_mask_nonzero</H3></A>
<PRE>public subroutine cswt_tr_mask_nonzero (tr_mask, ncoeff_eff, ncoeff_tot)
    type (cswt_tr), intent(in) :: tr_mask
    integer, intent(out), dimension (:,:) :: ncoeff_eff
    integer, intent(out) :: ncoeff_tot
    ! Calls: cswt_error
end subroutine cswt_tr_mask_nonzero
</PRE>
 Compute the number of non-zero values (i.e. effective remaining 
 coefficients) in a given mask.  (Computed for each dilation and
 orientation, i.e. for each alpha-beta `sky' of the mask.)
<P>
 Variables:
   <UL>
   <LI>  tr_mask: tr structure containing the mask in the tr_mask%wcoeff
     array.
   <LI>  ncoeff_eff: Number of effective coefficients in the mask for each
     dilation and orientation, i.e. for each alpha-beta `sky'.
   <LI>  ncoeff_tot: Total number of coefficients in a single alpha-beta
     mask.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_mask_nonzero_weight"><H3>cswt_tr_mask_nonzero_weight</H3></A>
<PRE>public subroutine cswt_tr_mask_nonzero_weight (tr_mask, prop)
    type (cswt_tr), intent(in) :: tr_mask
    real (kind=s2_sp), intent(out), dimension (:,:) :: prop
    ! Calls: cswt_error
end subroutine cswt_tr_mask_nonzero_weight
</PRE>
 Compute the proportion of weighted coefficients in a given mask. 
 (Computed for each dilation and orientation, i.e. for each alpha-beta 
 `sky' of the mask.)
<P>
 Notes:
   <UL>
   <LI>   The proportion is computed from
      .  \sum_{all i s.t. mask_i > thres} w_i
      .  ------------------------------------
      .            \sum_{all j} w_j
      for the map corresponding to each dilation and orientation.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr_mask: tr structure containing the mask in the tr_mask%wcoeff
     array.
   <LI>  prop: Proportion of effective weighted coefficients for each
     dilation and orientation, i.e. for each alpha-beta `sky'.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - December 2004
<A NAME="subroutine_cswt_tr_mask_invert"><H3>cswt_tr_mask_invert</H3></A>
<PRE>public subroutine cswt_tr_mask_invert (tr_mask)
    type (cswt_tr), intent(inout) :: tr_mask
    ! Calls: cswt_error
end subroutine cswt_tr_mask_invert
</PRE>
 Invert a coefficient mask by converting ones to zeros, and zeros to 
 ones.
<P>
 Variables:
   <UL>
   <LI>  tr_mask: Mask to invert.  On output contains ones in the place of
     original zeros, and zeros in the place of original ones.
<P>
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - January 2005
<A NAME="subroutine_cswt_tr_mask_apply"><H3>cswt_tr_mask_apply</H3></A>
<PRE>public subroutine cswt_tr_mask_apply (tr, tr_mask, display_in)
    type (cswt_tr), intent(inout) :: tr
    type (cswt_tr), intent(in) :: tr_mask
    logical, optional, intent(in) :: display_in
    ! Calls: cswt_error
end subroutine cswt_tr_mask_apply
</PRE>
 Apply an extended coefficient mask by multiplying the wavelet
 coefficients of the specified tr structure with the mask (contained 
 in the wavelet coefficients of the tr_mask structure).
<P>
 Notes:
   <UL>
   <LI>  <STRONG>Important</STRONG>: Only specify the display flag if the output may is 
     only used for display purposes.  If subsequent processing is 
     applied erroneous results amy occur.
   <LI>  Obviously the sizes of the tr and tr_mask structure must be the
     same.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: Wavelet transform structure to be masked.
   <LI>  tr_mask: Mask to apply.  Mask is stored in the tr_mask%wcoeff array.
   <LI>  [display]: Logical to specified whether a display mask is to be 
     applied.  If that is the case then the pixels in the tr structure
     corresponding to the zeros with be replaced with a large negative
     value so that they appear grey in output images.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_mask_thres_nsigma"><H3>cswt_tr_mask_thres_nsigma</H3></A>
<PRE>public subroutine cswt_tr_mask_thres_nsigma (tr, nsigma, n_effective_samples, mode)
    type (cswt_tr), intent(inout) :: tr
    real (kind=s2_sp), intent(in) :: nsigma
    integer, intent(in), dimension (:) :: n_effective_samples
    integer, intent(in) :: mode
    ! Calls: cswt_error, cswt_tr_wcoeff_sigma
end subroutine cswt_tr_mask_thres_nsigma
</PRE>
 Produce a mask from the wavelet coefficients contained in the tr 
 structure by thresholding the coefficients to binary 1,0 values.
 A range of thresholding 'directions' may be performed (see mode
 below), nevertheless each is realitive to the nsigma * sigma(a)
 (where sigma(a) is computed herein).
<P>
 Notes:
   <UL>
   <LI>  Note that on output the binary {0,1} mask is stored in the tr
     wavelet coefficient array. 
   <LI>  If tr wavelet coefficients masked, sigma and mean should be
     computed only over the remaining pixels.  If these pixels are zero,
     then they won't compute to the calculation of mean and sigma, 
     however the number of samples to divide by should be the effective
     number of pixels.  Thus divide by this value, for each dilation, 
     that is passed as an input.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: Strucutre containing wavelet coefficients to be thresholded 
     to construct the mask.  On exit, the binary mask is contained in
     the tr structure wavelet coefficient array.
   <LI>  nsigma: Number of sigma threshold is set at.
   <LI>  n_effective_samples: Number of effective samples per dilation
     for previously applied mask, if not masked just give full number
     of Euler angle samples (for each dilation - which of course will
     be an array of the same number (n_alpha*n_beta*n_gamma)).
   <LI>  mode: Mode of thresholding to perform.  
     If mode=CSWT_TR_THRES_NSIGMA_MODE_ABS then the absolute value of
     coefficients are considered and those coefficients above (in
     absolute value)  nsigma * sigma(a) are set to one, and the
     remainder to zero.
     If mode=CSWT_TR_THRES_NSIGMA_MODE_ABOVE then those coefficients 
     above nsigma * sigma(a) are set to one, and the remainder to zero.
     If mode=CSWT_TR_THRES_NSIGMA_MODE_BELOW then those coefficients 
     below -nsigma * sigma(a) (<STRONG>note minus sign</STRONG>)  are set to one,
     and the remainder to zero.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - December 2004
<A NAME="subroutine_cswt_tr_mask_copy"><H3>cswt_tr_mask_copy</H3></A>
<PRE>public subroutine cswt_tr_mask_copy (tr_mask, sky_mask)
    type (cswt_tr), intent(inout) :: tr_mask
    type (s2_sky), intent(in), dimension (:) :: sky_mask
    ! Calls: cswt_error, s2_sky_extract_ab
end subroutine cswt_tr_mask_copy
</PRE>
 Copy masks defined on the sky (Healpix format) for each dilation to 
 a cswt tr structure mask defined in the spherical wavelet coefficient 
 domain.  
<P>
 Notes:
   <UL>
   <LI>  The wavelet coefficients are not actually required in the 
     algorithm, however the wavelet transform structure of the correct
     size must be initialised.  To overcome this problem the tr_mask 
     structure containing the wavelet coefficient masks is often used.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr_mask: Spherical wavelet transform of sky mask. Overwritten with
     extended coefficient mask on output.  (Note that this strucutre 
     doesn't actually have to have the wavelet coefficients of the
     original sky map mask, however it is easier to just supply that.)
   <LI>  sky_mask: Array of sky masks for each dilation that are to be
     convert to the wavelet coefficient domain.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - December 2004
<A NAME="subroutine_cswt_tr_mask_gen"><H3>cswt_tr_mask_gen</H3></A>
<PRE>public subroutine cswt_tr_mask_gen (tr_mask, sky_mask, mode, run_stage1_in, run_stage2_in, orig_mask_only_in, thres1_proportion_in, thres2_proportion_in, thres1_min_in, std_in)
    type (cswt_tr), intent(inout) :: tr_mask
    type (s2_sky), intent(in) :: sky_mask
    integer, intent(in) :: mode
    logical, optional, intent(in) :: run_stage1_in
    logical, optional, intent(in) :: run_stage2_in
    logical, optional, intent(in) :: orig_mask_only_in
    real (kind=s2_sp), optional, intent(in) :: thres1_proportion_in
    real (kind=s2_sp), optional, intent(in) :: thres2_proportion_in
    real (kind=s2_sp), optional, intent(in) :: thres1_min_in
    real (kind=s2_sp), optional, intent(in), dimension (:) :: std_in
    ! Calls: cswt_error, cswt_tr_morph_dilate_ab, cswt_tr_morph_erode_ab, cswt_tr_smooth_gaussian_ab, s2_sky_extract_ab
end subroutine cswt_tr_mask_gen
</PRE>
 Generate an extended coefficient exclusion mask from an original sky
 mask and the spherical wavelet transform of the mask.
<P>
 Notes:
   <UL>
   <LI>  This routine may perform two different methods for generating the
     extended mask: (a) from spherical wavelet coefficients or 
     (b) by using morphological operations.  These are subsequently
     described.
   <LI>  (a) The extended coefficient exclusion mask is generated by taking
     the transform of the original sky mask.  The only non-zero wavelet 
     coefficients are those that are distorted by the mask boundary.  
     These distorted coefficients are detected by thresholding.  An 
     intermediate stage of smoothing (by convolving with a Gaussian
     kernel) is performed to smooth out whispy regions that otherwise
     remain when the wavelet support is exactly half contained in the 
     masked region and half not.  A second stage of thresholding is 
     performed to remove these regions once blurred.
   <LI>  (b) The extended coefficient exclusion mask is generated by 
     performing morphological operations on the original mask.  The 
     wavelet coefficients are not requried, however the wavelet 
     transform structure of the correct size must be initialised.  To
     overcome this problem the tr_mask structure is actually used (since
     it is already available) and simply overwritten with the new 
     extended mask.  The method itself involves first removing the point
     source mask regions by opening (morphological dialtion followed by
     erosion) the original mask.  The glactic plane exclusion region
     then remains.  This is extended simply by a morphological erosion
     operation where the erosion kernel size is given by the 2*effective 
     size of the wavelet on the sky.  A circular kernel shape is used.
   <LI>  <STRONG>Additional important note</STRONG>:  Morphological mask generation is only
     valid for the Mexhat, Morlet and Butterfly wavelets (or other 
     wavelets that are defined to have the same effective size on the 
     sky).  Modifications must be made for wavelets with a different
     effective size on the sky.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr_mask: Spherical wavelet transform of sky mask. Overwritten with
     extended coefficient mask on output.
   <LI>  sky_mask: Original sky mask to be extended.
   <LI>  mode: Integer to specifier what method of generating extended 
     coefficient mask to use.
   <LI>  [run_stage1]: Logical to specify whether to perform first stage 
     of thresholding.
   <LI>  [run_stage2]: Logical to specify whether to perform second stage 
     of thresholding.
   <LI>  [orig_mask_only_in]: Logical to specify if to just convert the 
     original sky mask to the wavelet domain without extending it.
   <LI>  [thres1_proportion_in]: Threshold proportion for the first stage
     of dynamic thresholding.
   <LI>  [thres2_proportion_in]: Threshold proportion for the second stage
     of dynamic thresholding.
   <LI>  [thres1_min_in]: Minimum threshold for the first stage of dynamic
     thresholding.
   <LI>  [std_in]: Standard deviation of Gaussian smoothing for each
     dilation index.  If not specified then calculated by default method
     from dilation values.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_morph_erode_ab"><H3>cswt_tr_morph_erode_ab</H3></A>
<PRE>private subroutine cswt_tr_morph_erode_ab (tr, i_dil, i_gamma, kernel_size, kernel_type)
    type (cswt_tr), intent(inout) :: tr
    integer, intent(in) :: i_dil
    integer, intent(in) :: i_gamma
    integer, intent(in) :: kernel_size
    integer, intent(in) :: kernel_type
    ! Calls: cswt_error
end subroutine cswt_tr_morph_erode_ab
</PRE>
 Morphologically erode an ecp alpha-beta map with either a square or
 circular kernel.
<P>
 Notes:
   <UL>
   <LI>  The input tr wavelet coefficient alpha-beta map must be a binary
     map (the ones in the map are eroded, i.e. zero component dilated).
   <LI>  Kernel size variable is positive size (so total size of kernel
     is 2*kernel_size + 1).
   <LI>  Both the dilation (i_dil) and <STRONG>orientation</STRONG> (i_gamma) are
     indexed from 1:N.
   <LI>  Overwrites the tr alpha and beta components with the 
     morphologically dilated values.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: tr structure containing wavelet coefficient that are 
     morphologically eroded.
   <LI>  i_dil: Dilation index of tr%wcoeff map to erode.
   <LI>  i_gamma: Gamma Euler angle index of tr%wcoeff to erode.
   <LI>  kernel_size: Size of 2D kernel in alpha and beta Euler angle
     dimension (must be odd).
   <LI>  kernel_type: Specifier to indicate shape of kernel to apply.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_morph_dilate_ab"><H3>cswt_tr_morph_dilate_ab</H3></A>
<PRE>private subroutine cswt_tr_morph_dilate_ab (tr, i_dil, i_gamma, kernel_size, kernel_type)
    type (cswt_tr), intent(inout) :: tr
    integer, intent(in) :: i_dil
    integer, intent(in) :: i_gamma
    integer, intent(in) :: kernel_size
    integer, intent(in) :: kernel_type
    ! Calls: cswt_error
end subroutine cswt_tr_morph_dilate_ab
</PRE>
 Morphologically dilate an ecp alpha-beta map with either a square or
 circular kernel.
<P>
 Notes:
   <UL>
   <LI>  The input tr wavelet coefficient alpha-beta map must be a binary
     map (the ones in the map are dilated).
   <LI>  Kernel size variable is positive size (so total size of kernel
     is 2*kernel_size + 1).
   <LI>  Both the dilation (i_dil) and <STRONG>orientation</STRONG> (i_gamma) are
     indexed from 1:N.
   <LI>  Overwrites the tr alpha and beta components with the 
     morphologically dilated values.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: tr structure containing wavelet coefficient that are 
     morphologically dilated.
   <LI>  i_dil: Dilation index of tr%wcoeff map to dilate.
   <LI>  i_gamma: Gamma Euler angle index of tr%wcoeff to dilate.
   <LI>  kernel_size: Size of 2D kernel in alpha and beta Euler angle
     dimension (must be odd).
   <LI>  kernel_type: Specifier to indicate shape of kernel to apply.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_smooth_gaussian"><H3>cswt_tr_smooth_gaussian</H3></A>
<PRE>public subroutine cswt_tr_smooth_gaussian (tr, kernel_size1, kernel_size2, std)
    type (cswt_tr), intent(inout) :: tr
    integer, intent(in) :: kernel_size1
    integer, intent(in) :: kernel_size2
    real (kind=s2_sp), intent(in), dimension (:,:) :: std
    ! Calls: cswt_error, cswt_tr_smooth_gaussian_ab
end subroutine cswt_tr_smooth_gaussian
</PRE>
 Smooth all tr%wcoeff maps over alpha-beta for each dilation and gamma
 Euler orientation.
<P>
 Notes:
   <UL>
   <LI>  Overwrites the tr wavelet coefficients with the smoothed values.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: tr structure containing wavelet coefficient that are smoothed.
   <LI>  kernel_size1: Size of 2D kernel in alpha Euler angle dimension 
     (must be odd).
   <LI>  kernel_size2: Size of 2D kernel in beta Euler angle dimension
     (must be odd).
   <LI>  std: Standard deviation of Gaussian used to smooth.  Array indexed
     over i_dil and i_gamma containing the standard deviation for each
     alpha-beta map.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_smooth_gaussian_ab"><H3>cswt_tr_smooth_gaussian_ab</H3></A>
<PRE>private subroutine cswt_tr_smooth_gaussian_ab (tr, kernel_size1, kernel_size2, std, i_dil, i_gamma)
    type (cswt_tr), intent(inout) :: tr
    integer, intent(in) :: kernel_size1
    integer, intent(in) :: kernel_size2
    real (kind=s2_sp), intent(in) :: std
    integer, intent(in) :: i_dil
    integer, intent(in) :: i_gamma
    ! Calls: cswt_error
end subroutine cswt_tr_smooth_gaussian_ab
</PRE>
 Smooth an ecp alpha-beta map by convolving it with a Gaussian kernel.
<P>
 Notes:
   <UL>
   <LI>  Both the dilation (i_dil) and <STRONG>orientation</STRONG> (i_gamma) are
     indexed from 1:N.
   <LI>  Overwrites the tr alpha and beta components with the smoothed 
     values.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: tr structure containing wavelet coefficient that are smoothed.
   <LI>  kernel_size1: Size of 2D kernel in alpha Euler angle dimension 
     (must be odd).
   <LI>  kernel_size2: Size of 2D kernel in beta Euler angle dimension
     (must be odd).
   <LI>  std: Standard deviation of Gaussian used to smooth.
   <LI>  i_dil: Dilation index of tr%wcoeff map to smooth.
   <LI>  i_gamma: Gamma Euler angle index of tr%wcoeff to smooth.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_extract_wcoeff_sky"><H3>cswt_tr_extract_wcoeff_sky</H3></A>
<PRE>public function cswt_tr_extract_wcoeff_sky (tr, i_dil, i_gamma, nside, interp, pix_scheme_in) result (sky)
    type (cswt_tr), intent(in) :: tr
    integer, intent(in) :: i_dil
    integer, intent(in) :: i_gamma
    integer, intent(in) :: nside
    logical, intent(in) :: interp
    integer, optional, intent(in) :: pix_scheme_in
    type (s2_sky) :: sky
    ! Calls: cswt_error
end function cswt_tr_extract_wcoeff_sky
</PRE>
 Extract a sky representation of the ecp (equi-sampled) spherical 
 wavelet coefficients for a given dilation and orientation.
<P>
 Notes:
   <UL>
   <LI>  Initialises a new sky form the wavelet coefficients of the tr
     structure.
   <LI>  The returned sky is subsequently independed of the tr structure
     and should be freed by the calling routine at some point.
   <LI>  Both the dilation (i_dil) and <STRONG>orientation</STRONG> (i_gamma) are
     indexed from 1:N.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: The tr structure containing the computed spherical wavelet 
     coefficients that are to be written to a sky representation.
   <LI>  i_dil: The dilation index of the spherical wavelet coefficients
     to write the sky representation of.
   <LI>  i_gamma: The orientation index of the spherical wavelet 
     coefficients to write the sky representation of.
   <LI>  nside: The Healpix nside resolution parameter of the constructed 
     sky.  
   <LI>  interp: Logical to specify whether linear interpolation is to be 
     performed.
   <LI>  [pix_scheme_in]:  Pixelisation scheme of initialised sky.  If not 
     specified then the default pixelisation scheme is used.
   <LI>  sky: Sky representation of the wavelet coefficients for the 
     specified dilation and orientation.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_io_fits_write_wcoeff_sky"><H3>cswt_tr_io_fits_write_wcoeff_sky</H3></A>
<PRE>public subroutine cswt_tr_io_fits_write_wcoeff_sky (filename, tr, i_dil, i_gamma, nside, interp, pix_scheme_in, comment)
    character (len=*), intent(in) :: filename
    type (cswt_tr), intent(in) :: tr
    integer, intent(in) :: i_dil
    integer, intent(in) :: i_gamma
    integer, intent(in) :: nside
    logical, intent(in) :: interp
    integer, optional, intent(in) :: pix_scheme_in
    character (len=*), optional, intent(in) :: comment
    ! Calls: cswt_error, s2_sky_free, s2_sky_write_map_file
end subroutine cswt_tr_io_fits_write_wcoeff_sky
</PRE>
 Extract a sky representation of the ecp (equi-sampled) spherical
 wavelet coefficients for a given dilation and orientation and write 
 them directly to a fits sky file.
<P>
 Notes:
   <UL>
   <LI>  Both the dilation (i_dil) and <STRONG>orientation</STRONG> (i_gamma) are
     indexed from 1:N.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of the output fits file to write the sky 
     representation of the wavelet coefficients to.
   <LI>  tr: The tr structure containing the computed spherical wavelet 
     coefficients that are to be written fits file sky representation.
   <LI>  i_dil: The dilation index of the spherical wavelet coefficients
     to write the sky representation of.
   <LI>  i_gamma: The orientation index of the spherical wavelet 
     coefficients to write the sky representation of.
   <LI>  nside: The Healpix nside resolution parameter of the constructed 
     sky.  
   <LI>  interp: Logical to specify whether linear interpolation is to be 
     performed.
   <LI>  [pix_scheme_in]:  Pixelisation scheme of initialised sky.  If not 
     specified then the default pixelisation scheme is used.
   <LI>  [comment]: Optional comment to add to the header of the output 
     fits file.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_io_fits_write_wcoeff"><H3>cswt_tr_io_fits_write_wcoeff</H3></A>
<PRE>public subroutine cswt_tr_io_fits_write_wcoeff (filename, tr, comment)
    character (len=*), intent(in) :: filename
    type (cswt_tr), intent(in) :: tr
    character (len=*), optional, intent(in) :: comment
    ! Calls: cswt_error, cswt_tr_io_fits_error_check, cswt_tr_io_fits_exists, ftclos, ftfiou, ftgiou, ftibin, ftiimg, ftinit, ftp3de, ftpcle, ftpcom, ftpdat, ftphpr, ftpkye, ftpkyj, ftpkys, s2_sky_admiss_dil, s2_sky_free, s2_sky_get_param
end subroutine cswt_tr_io_fits_write_wcoeff
</PRE>
 Write a tr structure to an output fits file.  Both the wavelet 
 coefficients and the dilation values are written (and other additional
 wavelet transform parameters).
<P>
 Variables:
   <UL>
   <LI>  filename: Name of the output fits file to write the tr structure
     data to.
   <LI>  tr: The tr structure containing the data to be written to the
     output fits file.
   <LI>  [comment]: Optional comment string to be added to the output fits 
     file header if present.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_io_fits_read_wcoeff"><H3>cswt_tr_io_fits_read_wcoeff</H3></A>
<PRE>private subroutine cswt_tr_io_fits_read_wcoeff (filename, tr)
    character (len=*), intent(in) :: filename
    type (cswt_tr), intent(out) :: tr
    ! Calls: cswt_error, cswt_tr_io_fits_error_check, cswt_tr_io_fits_exists, ftclos, ftfiou, ftg3de, ftgcve, ftgiou, ftgkye, ftgkyj, ftmahd, ftopen, ftthdu
end subroutine cswt_tr_io_fits_read_wcoeff
</PRE>
 Read a fits wavelet coefficient file and allocate a new tr structure
 with the data read.
<P>
 Notes:
   <UL>
   <LI>  The tr data structure is allocated herein by calling 
     cswt_tr_init_computed
   <LI>  No wavelet specific attributes are read from headers here since
     the wavelet itself is not contained in the file.  In some cases 
     the file may also be written from a previously read file (after
     manipulation) and wavelet attributes may not be present.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of the fits input file containing the wavelet
     transform data to be read.
   <LI>  tr: The initialised tr structure containing the data read from
     the input fits file.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_io_fits_error_check"><H3>cswt_tr_io_fits_error_check</H3></A>
<PRE>private subroutine cswt_tr_io_fits_error_check (status, halt)
    integer, intent(inout) :: status
    logical, intent(in) :: halt
    ! Calls: ftgerr, ftgmsg
end subroutine cswt_tr_io_fits_error_check
</PRE>
 Check if a fits error has occured and print error message.  Halt
 program execution if halt flag is set.
<P>
 Variables:
   <UL>
   <LI>  status: Fits integer status code.
   <LI>  halt: Logical to indicate whether to halt program execution if an 
     error is detected.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_io_fits_exists"><H3>cswt_tr_io_fits_exists</H3></A>
<PRE>private subroutine cswt_tr_io_fits_exists (filename, status, exists)
    character (len=*), intent(in) :: filename
    integer, intent(inout) :: status
    logical, intent(out) :: exists
    ! Calls: cswt_tr_io_fits_error_check, ftclos, ftfiou, ftgiou, ftopen
end subroutine cswt_tr_io_fits_exists
</PRE>
 Check if a fits file exists.
<P>
 Variables:
   <UL>
   <LI>  filename: Name of fits file to check existence of.
   <LI>  status: Fits integer status code.
   <LI>  exists: Logical indicating whether the fits file already exists.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_io_fits_del"><H3>cswt_tr_io_fits_del</H3></A>
<PRE>private subroutine cswt_tr_io_fits_del (filename, status)
    character (len=*), intent(in) :: filename
    integer, intent(inout) :: status
    ! Calls: ftcmsg, ftdelt, ftfiou, ftgiou, ftopen
end subroutine cswt_tr_io_fits_del
</PRE>
 Delete a fits file.
<P>
 Variables:
   <UL>
   <LI>  filename: Name of fits file to detele.
   <LI>  status: Fits integer status code.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_io_txt_dilation_write"><H3>cswt_tr_io_txt_dilation_write</H3></A>
<PRE>public subroutine cswt_tr_io_txt_dilation_write (filename, tr, unit)
    character (len=*), intent(in) :: filename
    type (cswt_tr), intent(in) :: tr
    integer, intent(in) :: unit
    ! Calls: cswt_error
end subroutine cswt_tr_io_txt_dilation_write
</PRE>
 Write tr structure dilation values to an output text file.
<P>
 Notes:
   <UL>
   <LI>  Units stored in tr%dilation is always in radians.  However 
     units read and written to file may be in either radians or arcmins.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of file to write dilations to.
   <LI>  tr: Tr struture containing the dilations to be written.
   <LI>  unit: Integer specifying the units to write the dilation values in
     (either in arcmins or radians depending of the global 
     CSWT_TR_DIL_UNIT_* specifier passed).
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_io_txt_dilation_read"><H3>cswt_tr_io_txt_dilation_read</H3></A>
<PRE>public subroutine cswt_tr_io_txt_dilation_read (filename, dilation)
    character (len=*), intent(in) :: filename
    real (kind=s2_sp), intent(out), allocatable, dimension (:,:) :: dilation
    ! Calls: cswt_error
end subroutine cswt_tr_io_txt_dilation_read
</PRE>
 Read dilation values from an input dilation text file.
<P>
 Notes:
   <UL>
   <LI>  Units stored in tr%dilation is always in radians.  However 
     units read and written to file may be in either radians or arcmins.
   <LI>  The dilation array is allocated herein and must be freed by the
     calling routine.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of the input dilation file to be read.
   <LI>  dilation: Array of dilation values read from the input file.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_get_init"><H3>cswt_tr_get_init</H3></A>
<PRE>public function cswt_tr_get_init (tr) result (init)
    type (cswt_tr), intent(in) :: tr
    logical :: init
end function cswt_tr_get_init
</PRE>
 Get init variable from the passed tr.
<P>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet transform object to get copy of variable of.
   <LI>  init: Copy of object init variable extracted.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_get_swav_mother"><H3>cswt_tr_get_swav_mother</H3></A>
<PRE>public function cswt_tr_get_swav_mother (tr) result (swav_mother)
    type (cswt_tr), intent(in) :: tr
    type (cswt_swav) :: swav_mother
    ! Calls: cswt_error
end function cswt_tr_get_swav_mother
</PRE>
 Get copy of swav_mother variable from the passed tr.
<P>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet transform object to get copy of variable of.
   <LI>  swav_mother: Copy of spherical mother wavelet extracted.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_get_wcoeff"><H3>cswt_tr_get_wcoeff</H3></A>
<PRE>public subroutine cswt_tr_get_wcoeff (tr, wcoeff)
    type (cswt_tr), intent(in) :: tr
    real (kind=s2_sp), intent(out), dimension (1:,0:,0:,0:) :: wcoeff
    ! Calls: cswt_error
end subroutine cswt_tr_get_wcoeff
</PRE>
 Get copy of the wavelet coefficients.
<P>
 Notes:
   <UL>
   <LI>  Note that the wcoeff data array is indexed from <STRONG>one</STRONG> for the
     dilation dimensions, but from <STRONG>zero</STRONG> for the Euler angle
     dimensions.
   <LI>  The size of the input wcoeff array is not checked and must adhere 
     to the dimensions of the tr%wcoeff array (and be index similarly 
     as described by the previous note). 
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet transform object to get copy of variable of.
   <LI>  swav_mother: Copy of spherical mother wavelet extracted.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_cswt_tr_get_dilation"><H3>cswt_tr_get_dilation</H3></A>
<PRE>public subroutine cswt_tr_get_dilation (tr, dilation)
    type (cswt_tr), intent(in) :: tr
    real (kind=s2_sp), intent(out), dimension (:,:) :: dilation
    ! Calls: cswt_error
end subroutine cswt_tr_get_dilation
</PRE>
 Get copy of dilation variable from the passed tr.
<P>
 Notes:
   <UL>
   <LI>  The size of the input dilation array is not checked and must adhere 
     to the dimensions of the tr%dilation array.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet transform object to get copy of variable of.
   <LI>  dilation: Copy of object dilation variable extracted.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_get_lmax"><H3>cswt_tr_get_lmax</H3></A>
<PRE>public function cswt_tr_get_lmax (tr) result (lmax)
    type (cswt_tr), intent(in) :: tr
    integer :: lmax
    ! Calls: cswt_error
end function cswt_tr_get_lmax
</PRE>
 Get copy of lmax variable from the passed tr.
<P>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet transform object to get copy of variable of.
   <LI>  lmax: Copy of object lmax variable extracted.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_get_mmax"><H3>cswt_tr_get_mmax</H3></A>
<PRE>public function cswt_tr_get_mmax (tr) result (mmax)
    type (cswt_tr), intent(in) :: tr
    integer :: mmax
    ! Calls: cswt_error
end function cswt_tr_get_mmax
</PRE>
 Get copy of mmax variable from the passed tr.
<P>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet transform object to get copy of variable of.
   <LI>  mmax: Copy of object mmax variable extracted.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_get_n_alpha"><H3>cswt_tr_get_n_alpha</H3></A>
<PRE>public function cswt_tr_get_n_alpha (tr) result (n_alpha)
    type (cswt_tr), intent(in) :: tr
    integer :: n_alpha
    ! Calls: cswt_error
end function cswt_tr_get_n_alpha
</PRE>
 Get copy of n_alpha variable from the passed tr.
<P>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet transform object to get copy of variable of.
   <LI>  n_alpha: Copy of object n_alpha variable extracted.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_get_n_beta"><H3>cswt_tr_get_n_beta</H3></A>
<PRE>public function cswt_tr_get_n_beta (tr) result (n_beta)
    type (cswt_tr), intent(in) :: tr
    integer :: n_beta
    ! Calls: cswt_error
end function cswt_tr_get_n_beta
</PRE>
 Get copy of n_beta variable from the passed tr.
<P>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet transform object to get copy of variable of.
   <LI>  n_beta: Copy of object n_beta variable extracted.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_get_n_gamma"><H3>cswt_tr_get_n_gamma</H3></A>
<PRE>public function cswt_tr_get_n_gamma (tr) result (n_gamma)
    type (cswt_tr), intent(in) :: tr
    integer :: n_gamma
    ! Calls: cswt_error
end function cswt_tr_get_n_gamma
</PRE>
 Get copy of n_gamma variable from the passed tr.
<P>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet transform object to get copy of variable of.
   <LI>  n_gamma: Copy of object n_gamma variable extracted.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_get_n_dilation"><H3>cswt_tr_get_n_dilation</H3></A>
<PRE>public function cswt_tr_get_n_dilation (tr) result (n_dilation)
    type (cswt_tr), intent(in) :: tr
    integer :: n_dilation
    ! Calls: cswt_error
end function cswt_tr_get_n_dilation
</PRE>
 Get copy of n_dilation variable from the passed tr.
<P>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet transform object to get copy of variable of.
   <LI>  n_dilaiton: Copy of object n_dilation variable extracted.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_get_wcoeff_status"><H3>cswt_tr_get_wcoeff_status</H3></A>
<PRE>public function cswt_tr_get_wcoeff_status (tr) result (wcoeff_status)
    type (cswt_tr), intent(in) :: tr
    logical :: wcoeff_status
    ! Calls: cswt_error
end function cswt_tr_get_wcoeff_status
</PRE>
 Get copy of wcoeff_status variable from the passed tr.
<P>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet transform object to get copy of variable of.
   <LI>  wcoeff_status: Copy of object wcoeff_status variable extracted.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="function_cswt_tr_get_swav_mother_status"><H3>cswt_tr_get_swav_mother_status</H3></A>
<PRE>public function cswt_tr_get_swav_mother_status (tr) result (swav_mother_status)
    type (cswt_tr), intent(in) :: tr
    logical :: swav_mother_status
    ! Calls: cswt_error
end function cswt_tr_get_swav_mother_status
</PRE>
 Get copy of swav_mother_status variable from the passed tr.
<P>
 Variables:
   <UL>
   <LI>  tr: Spherical wavelet transform object to get copy of variable of.
   <LI>  swav_mother_status: Copy of object swav_mother_status variable 
     extracted.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
</HTML>
