<HTML>
<HEAD>
  <TITLE> s2 v1.0 documentation </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" />
</HEAD>

<H1 ALIGN=center> s2 package documentation </H1>

<H3 ALIGN=center> <a href="http:/www.mrao.cam.ac.uk/~jdm57/">Jason McEwen </a></H3>

<P>
The s2 library contains functionality to support functions defined on
the sky and was developed primarily for astrophysical applications.
More generally, however, any arbitrary function defined on the sphere
may be represented.  Both real space map and harmonic
space spherical harmonic representations are supported.
<P>
Basic sky representations have been extended to simulate full sky noise
distributions and Gaussian cosmic microwave background realisations.
Support for the representation and convolution of beams is also provided.

<P>
The library design is based on object-oriented principles and is
implemented in Fortran 90.  Generally one must instantiate a class
object using the corresponding init routines.  The instatiated object
should be freed once it is no longer required with the corresponding
free routine (this deallocates all memory associated with the object).

<p>
A <a href=http://healpix.jpl.nasa.gov/>HEALPix</a> spherical
pixelisation scheme is adopted, although this may be extended in the
future to support other spherical pixelisations.  The spherical
harmonic transforms applied are all based on the routines provided by
<a href=http://healpix.jpl.nasa.gov/>HEALPix</a>.

<p>
For further details see the
<a href="../README.txt">README.txt</a>
file.



<HR>
<H2> Installation </H2>

<p>
The s2 package requires the
<a href="http://healpix.jpl.nasa.gov/">HEALPix</a>
and
<a
href="http://heasarc.gsfc.nasa.gov/docs/software/fitsio/fitsio.html">CFITSIO</a>
packages.  Please note that all s2 code is written in
Fortran 90 and a suitable Fortran compiler will be required.


<H3> Compiling library </H3>

Before compiling you may need to edit the <a href="../makefile">makefile</a> to specify your
compiler and to link with the appropriate libraries.  Once you have
set the makefile up for your system then the s2 library may be
compilied by running:
<blockquote>   
<code> >> make lib</code>
</blockquote>

For details on how to use the s2 library code see the documentation
<a href="#library">below<a>.

<H3> Compiling utility programs </H3>
<p>
The s2 utility programs may be compiled by running:
<blockquote>   
<code>>> make prog</code>
</blockquote>

For details on how to use the s2 utility programs see the documentation
<a href="#utility">below<a>.


<H3> Documentation </H3>
<p>
By default, the s2 code ships with only this single documentation
page.  The remainder of the documentation is automatically generated
from the source code using 
<a href="http://theory.lcs.mit.edu/~edemaine/f90doc/">f90doc</a>.  
Please ensure that you have f90doc installed in order to generate this
documentation.  Once f90doc is installed the documentation may be 
generated by running:
<blockquote>   
<code>>> make docs</code>
</blockquote>

<H3> Cleaning up </H3>

To clean up your version of the s2 code and return all code to its
original state run:
<blockquote>   
<code>>> make clean</code>
</blockquote>

To remove all documentation, except the front page (i.e. this file),
run:
<blockquote>   
<code>>> make cleandocs</code>
</blockquote>




<HR>
<a name="library"><H2> Library classes </H2></a>

An overview of the classes that comprise the s2 library is given
here.  Please click on the link for each class for detailed
documentation. 

<p>
<CODE><a href=s2_sky_mod.html>s2_sky_mod</a></CODE>: 
Provides functionality to support and manipulate a function defined
on the sky(/sphere). Support is provided to representing the sky in
both real (map) space and in harmonic (alm) space, and also to convert
between the two representations. One may also scale, dilate, rotate,
downsample and add functions defined on the sky. The sky pixelisation
used is currently based on HEALPix. 

<p>
<CODE><a href=s2_ylm_mod.html>s2_ylm_mod</a></CODE>: 
Provides functionality to compute spherical harmonic functions.

<p>
<CODE><a href=s2_dl_mod.html>s2_dl_mod</a></CODE>:
Functionality to compute specified plane of the Wigner dl functions.
(Provided by D. J. Mortlock.)

<p>
<CODE><a href=s2_pl_mod.html>s2_pl_mod</a></CODE>: 
 Provides functionality to support and manipulate a pl power spectrum.

<p>
<CODE><a href=s2_cmb_mod.html>s2_cmb_mod</a></CODE>: 
 Provides functionality to create a Gaussian simuated CMB map. The map
 is realised from Gaussain alms that satisfy the specified CMB power
 spectrum.

<p>
<CODE><a href=s2_wnoise_mod.html>s2_wnoise_mod</a></CODE>: 
 Provides functionality to support white noise realisations on the
 sky. Noise may either be constructed from a uniform standard
 devaition constant over the sky or from a standard deviation map that
 varies over the sky depending on the number of observations at a
 particular position on the sky.

<p>
<CODE><a href=s2_distn_mod.html>s2_distn_mod</a></CODE>: 
 Functionality to sample from uniform and Gaussian distributions.

<p>
<CODE><a href=s2_vect_mod.html>s2_vect_mod</a></CODE>: 
 Provide functionality to support and rotate vectors in R^3,
 represented in either cartesian or spherical coordinates.

<p>
<CODE><a href=s2_types_mod.html>s2_types_mod</a></CODE>: 
 Definition of intrinsic types and constants used in the s2 library.

<p>
<CODE><a href=s2_error_mod.html>s2_error_mod</a></CODE>: 
 Functionality to handle errors that may occur in the s2
 library. Public s2 error codes are defined, with corresponding
 private error comments and default halt execution status. 


<HR>
<a name="utility"><H2> Utility programs </H2></a>

Utility programs based on the s2 library are listed here.  More s2 
programs may appear here in the future as their need becomes
apparent.  Please click on the link for each program for detailed
documentation. 

<P>
<CODE><a href=s2_alm2map.html>s2_alm2map</a></CODE>: Read a HEALPix
 alm fits file, compute map and then write the map to a HEALPix map
 fits file.

<P>
<CODE><a href=s2_alm2sky.html>s2_alm2sky</a></CODE>: Read a HEALPix
alm fits file and write the read map to a full s2_sky fits
file. Compute map if requested.

<P>
<CODE><a href=s2_cl2ascii.html>s2_cl2ascii</a></CODE>: 
 Read a fits cl file and write out an ascii file (spectrum may be
 scaled to dls depending on dl_status flag). 

<P>
<CODE><a href=s2_dlwrite.html>s2_dlwrite</a></CODE>:
Write out Wigner d function values for theta=pi/2.

<P>
<CODE><a href=s2_gcmb.html>s2_gcmb</a></CODE>: 
 Generate a Gaussian CMB realisation from an input power spectrum.

<P>
<CODE><a href=s2_gcmbcoad.html>s2_gcmbcoad</a></CODE>: Generate
co-added Gaussian CMB and noise realisations. Realisations are
simulated for each WMAP channel by convolving with the approriate beam
function and adding appropriate noise for the specific receiver. The
signals from each receiver are combined to give a coadded map, using
the processing pipeline specified by Komatsu et al. (2003).

<P>
<CODE><a href=s2_grf2.html>s2_grf2</a></CODE>: 
 Simulate two Gaussian random fields (GRFs) on the sky that satisfy
 individual and cross power spectra. -- NOT TESTED

<P>
<CODE><a href=s2_map2alm.html>s2_map2alm</a></CODE>: Read a HEALPix
map fits file and write the read map to a HEALPix fits alm file.

<P>
<CODE><a href=s2_map2sky.html>s2_map2sky</a></CODE>: 
 Read a HEALPix map fits file and write the read map to a full s2_sky
 fits file. 

<P>
<CODE><a href=s2_nmask.html>s2_nmask</a></CODE>: 
Generate noisy masks and computed harmonic space noise covariance matrix
(not yet outputted) from a binary mask.

<P>
<CODE><a href=s2_nonzero.html>s2_nonzero</a></CODE>: 
 Count the number of non-zero values in a map. Two techniques are
 used. One assumes the map is binary and sums the values. The other
 counts the number of values above a threshold. The results are
 printed to the screen. 

<P>
<CODE><a href=s2_plplot.html>s2_plplot</a></CODE>: 
 Read a fit pl file and plot the values to and output postscript
 file. 

<P>
<CODE><a href=s2_sky2alm.html>s2_sky2alm</a></CODE>: Read a HEALPix
map fits file and write the read map to a full s2_sky fits file.

<P>
<CODE><a href=s2_sky2cl.html>s2_sky2cl</a></CODE>: 
 Read a map from a fits file, compute the alms of the map and then the
 cl spectrum. Write the computed cl spectrum values to the standard
 output.

<P>
<CODE><a href=s2_sky2fsht.html>s2_sky2fsht</a></CODE>: 
Read a HEALPix pixelised sky file (map or sky format) and extra an ecp
(equispaced) sampled theta-phi array over the sphere for the grid used
for the Fast Spherical Harmonic Transform. 

<P>
<CODE><a href=s2_sky2map.html>s2_sky2map</a></CODE>: 
 Read a full s2_sky file and write the map to a HEALPix fits file. 

<P>
<CODE><a href=s2_sky2plplot.html>s2_sky2plplot</a></CODE>: 
 Read a full fits s2_sky file and compute and plot the cl spectrum
 (dilate sky also if required). 

<P>
<CODE><a href=s2_skyadd.html>s2_skyadd</a></CODE>: 
 Add or subtract two maps of the sky.

<P>
<CODE><a href=s2_skydown.html>s2_skydown</a></CODE>: 
 Downsample a sky.

<P>
<CODE><a href=s2_skyerror.html>s2_skyerror</a></CODE>: 
Compute error between two sky maps.

<P>
<CODE><a href=s2_skymask.html>s2_skymask</a></CODE>: 
 Apply a mask (containing only ones and zeros) to a sky. The output
 map is the product of the mask and sky maps. If the display status is
 set then masked pixels of the output map are overwritten with a magic
 number that appears grey when plotted. Output maps producted with the
 display option set should only be used for display purposes, and not
 for any subsequent analysis.

<P>
<CODE><a href=s2_skymultiply.html>s2_skymultiply</a></CODE>: 
 Multiply sky by constant scale.

<P>
<CODE><a href=s2_skyoffset.html>s2_skyoffset</a></CODE>: 
Add a constant offset to a sky.

<P>
<CODE><a href=s2_skyorder.html>s2_skyorder</a></CODE>: 
Change the pixelisation ordering scheme of a sky.

<P>
<CODE><a href=s2_skyprod.html>s2_skyprod</a></CODE>: 
 Take the product of two maps of the sky.

<P>
<CODE><a href=s2_skyrms.html>s2_skyrms</a></CODE>:
Compute RMS value of sky map.

<P>
<CODE><a href=s2_skyrot.html>s2_skyrot</a></CODE>: 
Rotate a sky.

<P>
<CODE><a href=s2_skythres.html>s2_skythres</a></CODE>: 
Threshold sky.

<P>
<CODE><a href=s2_skyup.html>s2_skyup</a></CODE>: 
 Up-sample a sky.

<P>
<CODE><a href=s2_ylm.html>s2_ylm</a></CODE>: 
Compute spherical harmonic function on full sky.


<HR>
<H2> Support  </H2>

For support or to report any bugs please contact Jason McEwen 
(<CODE>mcewen@mrao.cam.ac.uk</CODE>).



<HR>
<H2> Reference  </H2>

The s2 package was written originally for the development of fast
continuous wavelet transform algorithms on the sphere but has since
evolved to provide much additional functionality.  If you use the code
to produce published works please reference the download site
<a
href=http://www.mrao.cam.ac.uk/~jdm57/>http://www.mrao.cam.ac.uk/~jdm57/</a>
and our related paper:

<blockquote>
J. D. McEwen, M. P. Hobson, D. J. Mortlock, and A. N. Lasenby. 
<a
href="http://www.mrao.cam.ac.uk/~jdm57/publications.html#mcewen:2006:fcswt">Fast
directional continuous spherical wavelet transform algorithms</a>, IEEE Trans. Sig. Proc., 55(2):520-529,
2007.
</blockquote>

<HR>
<H2> Version </H2>

<P>
<STRONG>Author:</STRONG> J. D. McEwen (<CODE>mcewen@mrao.cam.ac.uk</CODE>)
<P>
<STRONG>Version:</STRONG> 1.0 - July 2008

<H3> Version History </H3>

<ul>


<li>Version 1.0<br>
Initial public release.

<p>
<li>Version 0.2<br>
Name changed to s2.  Additional functionality added.

<P>
<li>Version 0.1<br>
Original SPH version.

</ul>


<HR>
<H2> License </H2>

     <blockquote>
     <p>
     s2 package to provide object oriented functionality for
     functions on the sphere<br>
     Copyright (C) 2008  Jason McEwen

     <p>
     This program is free software; you can redistribute it and/or
     modify it under the terms of the GNU General Public License
     as published by the Free Software Foundation; either version 2
     of the License, or (at your option) any later version.

     <p>
     This program is distributed in the hope that it will be useful,
     but WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
     GNU General Public License for more details 
     (<a href="../LICENSE.txt">LICENSE.txt</a>).

     <p>
     You should have received a copy of the GNU General Public License
     along with this program; if not, write to the Free Software
     Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, 
     MA  02110-1301, USA.

     </blockquote>


<HR>
<H2> Acknowledgements </H2>

<p>
JDM would like to thank Daniel Mortlock for useful discussions on the
design of the library and also for providing the routines that compute dl matrices.

<p>
This documentation has been generated largely by <a
href="http://theory.lcs.mit.edu/~edemaine/f90doc/">f90doc</a>, with
some minor modifications.

<HR>
<p align=right>
<font size="0.8em">Last modified: 1 July 2008</font>

</HTML>

